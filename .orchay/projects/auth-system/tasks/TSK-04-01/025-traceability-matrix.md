# TSK-04-01 - 요구사항 추적 매트릭스

## 문서 정보

| 항목 | 내용 |
|------|------|
| Task ID | TSK-04-01 |
| 문서 버전 | 1.0 |
| 작성일 | 2026-01-26 |

---

## 1. PRD → 설계 추적

| PRD 요구사항 | 설계 항목 | 구현 파일 | 테스트 ID |
|-------------|----------|----------|----------|
| PRD 4.3.1 인증 로그 | 2.1 감사 로그 타입 정의 | `lib/audit/audit-logger.ts` | UT-01~03 |
| PRD 4.3.2 권한 변경 로그 | 3.2 인증 이벤트 통합 | 기존 API 수정 | IT-07~08 |
| PRD 4.3.3 접근 감사 로그 | 2.1 UNAUTHORIZED_ACCESS | `lib/audit/audit-logger.ts` | IT-06 |
| PRD 4.3.4 감사 로그 조회 | 2.2~2.5 API 설계 | `app/api/audit-logs/` | IT-01~05 |

---

## 2. 설계 → 테스트 추적

| 설계 섹션 | 기능 | 테스트 유형 | 테스트 ID |
|----------|------|------------|----------|
| 3.1 createAuditLog | 감사 로그 생성 | 단위 테스트 | UT-01, UT-02, UT-03 |
| 2.3 GET /api/audit-logs | 목록 조회 | 통합 테스트 | IT-01, IT-02, IT-03 |
| 2.4 GET /api/audit-logs/:id | 상세 조회 | 통합 테스트 | IT-04 |
| 2.5 GET /api/audit-logs/export | CSV 내보내기 | 통합 테스트 | IT-05 |
| 3.2 인증 이벤트 통합 | 로그인/로그아웃 로깅 | 통합 테스트 | IT-07, IT-08 |

---

## 3. API → 권한 추적

| API 엔드포인트 | 필요 권한 | 검증 테스트 |
|---------------|----------|------------|
| GET /api/audit-logs | audit-log:read | IT-06 |
| GET /api/audit-logs/:id | audit-log:read | IT-06 |
| GET /api/audit-logs/export | audit-log:export | IT-06 |

---

## 4. 에러 처리 추적

| 에러 상황 | 설계 섹션 | HTTP 상태 | 테스트 ID |
|----------|----------|----------|----------|
| 인증 안됨 | 5. 에러 처리 | 401 | IT-06 |
| 권한 없음 | 5. 에러 처리 | 403 | IT-06 |
| 로그 없음 | 5. 에러 처리 | 404 | IT-04 |
| 잘못된 파라미터 | 5. 에러 처리 | 400 | IT-09 |

---

## 5. 비즈니스 규칙 추적

| 규칙 ID | 규칙 설명 | 구현 위치 | 테스트 ID |
|---------|----------|----------|----------|
| BR-01 | 감사 로그 삭제 불가 | DELETE API 미구현 | - |
| BR-02 | audit-log:read 권한 필요 | API 미들웨어 | IT-06 |
| BR-03 | audit-log:export 권한 필요 | API 미들웨어 | IT-06 |
| BR-04 | 페이지 크기 최대 100개 | API 유효성 검증 | IT-09 |
| BR-05 | 날짜 필터 최대 1년 | API 유효성 검증 | IT-09 |

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-26 | Claude | 최초 작성 |
