# TSK-05-01 - 사용자 관리 화면 설계 문서

## 문서 정보

| 항목 | 내용 |
|------|------|
| Task ID | TSK-05-01 |
| 문서 버전 | 1.0 |
| 작성일 | 2026-01-26 |
| 상태 | 승인됨 |
| 카테고리 | development |
| 도메인 | frontend |

---

## 1. 개요

### 1.1 배경 및 문제 정의

**현재 상황:**
- Auth System의 API 계층(인증, 인가, 감사로그)이 구현됨
- 사용자 관리를 위한 UI가 없어 관리자가 사용자를 관리할 수 없음

**해결하려는 문제:**
- 관리자가 사용자를 조회, 등록, 수정, 삭제할 수 있는 화면 필요
- 사용자 역할 할당 인터페이스 필요
- 계정 잠금/해제, 비밀번호 초기화 기능 필요

### 1.2 목적 및 기대 효과

**목적:**
- 사용자 관리 CRUD 화면 구현
- 역할 할당 인터페이스 구현
- 계정 관리 기능 (잠금/해제, 비밀번호 초기화)

**기대 효과:**
- 관리자가 웹 UI를 통해 사용자 관리 가능
- 권한 기반 버튼 표시로 보안 강화

### 1.3 범위

**포함:**
- 사용자 목록 화면 (검색, 필터, 페이징)
- 사용자 등록/수정 모달
- 역할 할당 인터페이스
- 계정 잠금/해제 버튼
- 비밀번호 초기화 버튼

**제외:**
- API 구현 (기존 /api/users 활용)

### 1.4 참조 문서

| 문서 | 경로 | 관련 섹션 |
|------|------|----------|
| PRD | `.orchay/projects/auth-system/prd.md` | PRD 4.4.1 |
| TRD | `.orchay/projects/auth-system/trd.md` | TRD 10.4 |

---

## 2. 화면 설계

### 2.1 화면 흐름도

```
사용자 목록
    │
    ├── [등록] → 사용자 등록 모달
    │               └── 저장 → 목록으로
    │
    ├── [수정] → 사용자 수정 모달
    │               └── 저장 → 목록으로
    │
    ├── [역할 할당] → 역할 선택 모달
    │                   └── 저장 → 목록으로
    │
    ├── [잠금/해제] → 확인 다이얼로그 → 목록 갱신
    │
    └── [비밀번호 초기화] → 확인 다이얼로그 → 목록 갱신
```

### 2.2 사용자 목록 화면

**경로:** `/admin/users`

**와이어프레임:**
```
┌─────────────────────────────────────────────────────────────────────┐
│  사용자 관리                                            [+ 사용자 등록] │
├─────────────────────────────────────────────────────────────────────┤
│  검색: [이름/이메일 _______________] [상태 ▼] [역할 ▼] [검색]          │
├─────────────────────────────────────────────────────────────────────┤
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │ ☐ │ 이름     │ 이메일           │ 부서   │ 역할    │ 상태 │ 액션│ │
│  ├───┼─────────┼─────────────────┼───────┼────────┼─────┼─────┤ │
│  │ ☐ │ 홍길동   │ hong@example.com│ 개발팀 │ 관리자  │ 활성 │ ... │ │
│  │ ☐ │ 김철수   │ kim@example.com │ 운영팀 │ 사용자  │ 잠금 │ ... │ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                      │
│  ◀ 1 2 3 ... 10 ▶                                                   │
└─────────────────────────────────────────────────────────────────────┘
```

**테이블 컬럼:**
| 컬럼 | 설명 | 정렬 |
|------|------|------|
| 선택 | 체크박스 | - |
| 이름 | 사용자명 | 가능 |
| 이메일 | 이메일 주소 | 가능 |
| 부서 | 소속 부서 | 가능 |
| 역할 | 할당된 역할 (태그) | - |
| 상태 | 활성/비활성/잠금 (Badge) | 가능 |
| 액션 | 수정, 삭제, 역할 할당, 잠금/해제, 비밀번호 초기화 | - |

**필터:**
- 이름/이메일 검색
- 상태 필터 (전체, 활성, 비활성, 잠금)
- 역할 필터 (다중 선택)

### 2.3 사용자 등록/수정 모달

**와이어프레임:**
```
┌──────────────────────────────────────────────┐
│  사용자 등록                              [X] │
├──────────────────────────────────────────────┤
│                                              │
│  이메일 *                                     │
│  [_____________________________________]     │
│                                              │
│  이름 *                                       │
│  [_____________________________________]     │
│                                              │
│  연락처                                       │
│  [_____________________________________]     │
│                                              │
│  부서                                         │
│  [선택 _________________________ ▼]          │
│                                              │
│  역할 *                                       │
│  [☑ 관리자] [☐ 사용자] [☐ 보안 관리자]        │
│                                              │
│  활성화                                       │
│  [◉ 활성] [○ 비활성]                         │
│                                              │
├──────────────────────────────────────────────┤
│                        [취소]  [저장]         │
└──────────────────────────────────────────────┘
```

**입력 필드:**
| 필드 | 타입 | 필수 | 유효성 규칙 |
|------|------|------|------------|
| 이메일 | Input (email) | O | 이메일 형식, 중복 불가 |
| 이름 | Input | O | 2-50자 |
| 연락처 | Input | X | 전화번호 형식 |
| 부서 | Select | X | - |
| 역할 | Checkbox Group | O | 최소 1개 |
| 활성화 | Radio | O | - |

---

## 3. 컴포넌트 설계

### 3.1 컴포넌트 구조

```
app/(portal)/admin/users/
├── page.tsx                    # 사용자 목록 페이지
├── components/
│   ├── UserTable.tsx          # 사용자 테이블
│   ├── UserForm.tsx           # 등록/수정 폼
│   ├── UserSearchForm.tsx     # 검색 폼
│   ├── RoleAssignModal.tsx    # 역할 할당 모달
│   └── UserActionMenu.tsx     # 액션 메뉴 (Dropdown)
└── hooks/
    └── useUsers.ts            # 사용자 데이터 훅
```

### 3.2 주요 컴포넌트

**UserTable.tsx:**
- Ant Design Table 사용
- 페이징, 정렬 지원
- 권한 기반 액션 버튼 표시

**UserForm.tsx:**
- Ant Design Form + Modal 사용
- 등록/수정 모드 분기
- zod 유효성 검증

**UserSearchForm.tsx:**
- Ant Design Form + Input + Select 사용
- 실시간 필터링

---

## 4. API 연동

### 4.1 사용할 API

| 메서드 | 엔드포인트 | 용도 |
|-------|-----------|------|
| GET | /api/users | 목록 조회 |
| GET | /api/users/:id | 상세 조회 |
| POST | /api/users | 등록 |
| PUT | /api/users/:id | 수정 |
| DELETE | /api/users/:id | 삭제 (비활성화) |
| POST | /api/users/:id/lock | 잠금 |
| POST | /api/users/:id/unlock | 잠금 해제 |
| POST | /api/users/:id/password/reset | 비밀번호 초기화 |
| GET | /api/users/:id/roles | 역할 조회 |
| PUT | /api/users/:id/roles | 역할 할당 |
| GET | /api/roles | 역할 목록 (선택용) |

---

## 5. 권한 제어

### 5.1 필요 권한

| 기능 | 권한 코드 |
|------|----------|
| 목록 조회 | user:read |
| 등록 | user:create |
| 수정 | user:update |
| 삭제 | user:delete |
| 잠금/해제 | user:lock |
| 비밀번호 초기화 | user:password-reset |
| 역할 할당 | user:assign-role |

### 5.2 권한 기반 UI

```tsx
// 예시
{can('create', 'User') && <Button>등록</Button>}
{can('update', 'User') && <Button>수정</Button>}
{can('delete', 'User') && <Button danger>삭제</Button>}
```

---

## 6. 테스트 케이스 요약

| ID | 테스트 케이스 | 유형 |
|----|-------------|------|
| TC-01 | 사용자 목록 조회 | 통합 |
| TC-02 | 사용자 검색 | 통합 |
| TC-03 | 사용자 등록 | 통합 |
| TC-04 | 사용자 수정 | 통합 |
| TC-05 | 사용자 삭제 | 통합 |
| TC-06 | 역할 할당 | 통합 |
| TC-07 | 계정 잠금/해제 | 통합 |
| TC-08 | 비밀번호 초기화 | 통합 |
| TC-09 | 권한 없는 버튼 숨김 | 단위 |

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-26 | Claude | 최초 작성 |
