# TSK-05-02 - 역할/권한 관리 및 감사로그 조회 화면 설계 문서

## 문서 정보

| 항목 | 내용 |
|------|------|
| Task ID | TSK-05-02 |
| 문서 버전 | 1.0 |
| 작성일 | 2026-01-26 |
| 상태 | 승인됨 |
| 카테고리 | development |
| 도메인 | frontend |

---

## 1. 개요

### 1.1 배경 및 문제 정의

**현재 상황:**
- 역할/권한 API가 구현됨 (TSK-03-01)
- 감사 로그 API가 구현됨 (TSK-04-01)
- 관리 화면이 없어 관리자가 직접 관리할 수 없음

**해결하려는 문제:**
- 역할 관리 화면 필요
- 권한 관리 화면 필요
- 감사 로그 조회 화면 필요

### 1.2 목적 및 기대 효과

**목적:**
- 역할 CRUD 화면 구현
- 역할-권한 매핑 화면 구현
- 감사 로그 조회 화면 구현

**기대 효과:**
- 관리자가 역할/권한을 웹 UI로 관리 가능
- 감사 로그 검색 및 내보내기 가능

### 1.3 범위

**포함:**
- 역할 목록/등록/수정/삭제 화면
- 역할-권한 매핑 화면
- 감사 로그 조회 화면 (필터, 페이징, 내보내기)

**제외:**
- 권한 CRUD 화면 (Phase 2)

### 1.4 참조 문서

| 문서 | 경로 | 관련 섹션 |
|------|------|----------|
| PRD | `.orchay/projects/auth-system/prd.md` | PRD 4.4.2, 4.4.3, 4.4.4 |
| TRD | `.orchay/projects/auth-system/trd.md` | TRD 10.4 |

---

## 2. 화면 설계

### 2.1 역할 관리 화면

**경로:** `/admin/roles`

**와이어프레임:**
```
┌─────────────────────────────────────────────────────────────────────┐
│  역할 관리                                              [+ 역할 등록] │
├─────────────────────────────────────────────────────────────────────┤
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │ 역할명      │ 역할 코드       │ 상위 역할  │ 상태 │ 액션       │ │
│  ├────────────┼────────────────┼───────────┼─────┼────────────┤ │
│  │ 시스템 관리자│ SYSTEM_ADMIN   │ -         │ 활성 │ [수정][삭제]│ │
│  │ 보안 관리자 │ SECURITY_ADMIN │ 시스템관리자│ 활성 │ [수정][삭제]│ │
│  │ 운영 관리자 │ OPERATION_ADMIN│ 시스템관리자│ 활성 │ [수정][삭제]│ │
│  └────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 역할-권한 매핑 화면

**경로:** `/admin/roles/:id/permissions` (또는 모달)

**와이어프레임:**
```
┌─────────────────────────────────────────────────────────────────────┐
│  권한 설정 - 시스템 관리자                                       [X] │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ☑ 사용자 관리                    ☑ 감사 로그                      │
│    ☑ user:read                     ☑ audit-log:read                │
│    ☑ user:create                   ☑ audit-log:export              │
│    ☑ user:update                                                    │
│    ☑ user:delete                  ☑ 역할 관리                      │
│                                     ☑ role:read                     │
│  ☑ 권한 관리                       ☑ role:create                   │
│    ☑ permission:read               ☑ role:update                   │
│    ☑ permission:create             ☑ role:delete                   │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│                                        [취소]  [저장]               │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.3 감사 로그 조회 화면

**경로:** `/admin/audit-logs`

**와이어프레임:**
```
┌─────────────────────────────────────────────────────────────────────┐
│  감사 로그                                               [📥 내보내기]│
├─────────────────────────────────────────────────────────────────────┤
│  기간: [2026-01-01] ~ [2026-01-31]  액션: [전체 ▼]  상태: [전체 ▼]   │
│  사용자: [전체 ▼]  [검색]                                            │
├─────────────────────────────────────────────────────────────────────┤
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │ 일시              │ 사용자  │ 액션      │ 리소스 │ 상태 │ IP    │ │
│  ├──────────────────┼────────┼──────────┼───────┼─────┼───────┤ │
│  │ 2026-01-26 10:00 │ 홍길동  │ LOGIN    │ -     │ ● 성공│ 192.. │ │
│  │ 2026-01-26 10:05 │ 김철수  │ LOGIN_FAILED│ -  │ ● 실패│ 192.. │ │
│  │ 2026-01-26 10:10 │ 홍길동  │ USER_CREATED│ User│ ● 성공│ 192.. │ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                      │
│  ◀ 1 2 3 ... 100 ▶                                                  │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 3. 컴포넌트 설계

### 3.1 역할 관리

```
app/(portal)/admin/roles/
├── page.tsx                    # 역할 목록 페이지
└── components/
    ├── RoleTable.tsx          # 역할 테이블
    ├── RoleForm.tsx           # 역할 등록/수정 폼
    └── PermissionModal.tsx    # 권한 설정 모달
```

### 3.2 감사 로그

```
app/(portal)/admin/audit-logs/
├── page.tsx                    # 감사 로그 페이지
└── components/
    ├── AuditLogTable.tsx      # 로그 테이블
    ├── AuditLogFilter.tsx     # 필터 폼
    └── AuditLogDetail.tsx     # 상세 모달
```

---

## 4. API 연동

### 4.1 역할 관리 API

| 메서드 | 엔드포인트 | 용도 |
|-------|-----------|------|
| GET | /api/roles | 역할 목록 |
| POST | /api/roles | 역할 등록 |
| PUT | /api/roles/:id | 역할 수정 |
| DELETE | /api/roles/:id | 역할 삭제 |
| GET | /api/roles/:id/permissions | 역할 권한 조회 |
| PUT | /api/roles/:id/permissions | 역할 권한 설정 |
| GET | /api/permissions | 권한 목록 |

### 4.2 감사 로그 API

| 메서드 | 엔드포인트 | 용도 |
|-------|-----------|------|
| GET | /api/audit-logs | 로그 목록 |
| GET | /api/audit-logs/:id | 로그 상세 |
| GET | /api/audit-logs/export | CSV 내보내기 |

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-26 | Claude | 최초 작성 |
