# TSK-02-01 설계 리뷰 보고서

**Template Version:** 1.0.0 — **Last Updated:** 2026-01-20

---

## 0. 리뷰 메타데이터

| 항목 | 내용 |
|------|------|
| Task ID | TSK-02-01 |
| Task명 | MDI 상태 관리 |
| 리뷰어 | claude-1 |
| 리뷰 일자 | 2026-01-20 |
| 설계 문서 버전 | 1.0 |
| 리뷰 유형 | 다층 품질 검증 (아키텍처/보안/품질) |

---

## 1. 검증 대상 문서

| 문서 | 상태 | 비고 |
|------|------|------|
| 010-design.md | ✅ 확인 | MDI 상태 관리 통합 설계 |
| 025-traceability-matrix.md | ✅ 확인 | 요구사항 추적성 매트릭스 |
| 026-test-specification.md | ✅ 확인 | 테스트 명세서 |

---

## 2. 검증 결과 요약

| 검증 영역 | 평가 | 비고 |
|----------|------|------|
| 문서 완전성 | PASS | 필수 섹션 모두 포함 |
| 요구사항 추적성 | WARN | 2건 FR 누락 (전체/다른탭 닫기) |
| 아키텍처 | WARN | 확장성 설계 보완 필요 |
| 보안 | WARN | P1 보안 이슈 4건 |
| 테스트 가능성 | PASS | UT 10, E2E 5 정의 |

---

## 3. 이슈 분포

| 심각도 | 개수 |
|--------|------|
| Critical | 1 |
| High | 6 |
| Medium | 8 |
| Low | 4 |
| Info | 5 |
| **합계** | **24** |

| 우선순위 | 개수 |
|----------|------|
| P1 | 4 |
| P2 | 5 |
| P3 | 6 |
| P4 | 5 |
| P5 | 4 |

---

## 4. 상세 이슈 목록

### 4.1 아키텍처 관점

#### ARCH-001: MDI Context 단일 책임 비대화 가능성

| 항목 | 내용 |
|------|------|
| **영역** | SOLID (Single Responsibility) |
| **심각도** | Medium |
| **우선순위** | P3 |
| **설계 섹션** | 6.1 탭 액션 API, 8.1 핵심 규칙 |
| **문제** | `openTab` 함수가 탭 추가, 중복 검사, 최대 탭 검사, 활성 탭 설정 등 여러 책임 담당 |
| **권장 조치** | 비즈니스 규칙 검증을 별도 유틸리티 함수 또는 `useMDIActions` 훅으로 분리 검토 |

#### ARCH-002: 영속성 어댑터 패턴 설계 부재

| 항목 | 내용 |
|------|------|
| **영역** | 확장성 |
| **심각도** | Medium |
| **우선순위** | P2 |
| **설계 섹션** | 7.2 상태 저장 |
| **문제** | sessionStorage 영속성 구현 전략이 "(선택)"으로만 언급되고 구체적 패턴 없음 |
| **권장 조치** | `interface MDIPersistence { save(): void; restore(): MDIState | null; }` 어댑터 패턴 도입 |

#### ARCH-003: 추가 액션 확장 전략 미정의

| 항목 | 내용 |
|------|------|
| **영역** | 확장성 |
| **심각도** | Medium |
| **우선순위** | P3 |
| **설계 섹션** | 6.1 탭 액션 API |
| **문제** | TSK-02-03, TSK-02-04에서 필요한 `reorderTabs`, `closeOthers`, `closeToRight` 등 확장 전략 부재 |
| **권장 조치** | 예약된 확장 API 섹션 추가 또는 useReducer 패턴 도입으로 액션 확장성 확보 |

#### ARCH-004: 탭 타입 확장 메커니즘 미정의

| 항목 | 내용 |
|------|------|
| **영역** | SOLID (Open/Closed) |
| **심각도** | Low |
| **우선순위** | P4 |
| **설계 섹션** | 5.2 탭 데이터 구조 |
| **문제** | 특수 탭 타입(모달 탭, 외부 링크 탭)에 대한 확장 전략 미명시 |
| **권장 조치** | `type?: 'default' | 'modal' | 'external'` 필드 예약 또는 확장 가이드 문서화 |

#### ARCH-005: maxTabs 설정 주입 경로 불명확

| 항목 | 내용 |
|------|------|
| **영역** | 확장성 |
| **심각도** | Low |
| **우선순위** | P4 |
| **설계 섹션** | 7.1 필요한 데이터, 8.1 BR-02 |
| **문제** | 최대 탭 개수 설정 값을 어디서 주입받는지 불명확 |
| **권장 조치** | `MDIProvider`에 `config?: { maxTabs?: number }` props 추가 |

#### ARCH-006: Context 리렌더링 최적화 방안 누락

| 항목 | 내용 |
|------|------|
| **영역** | 아키텍처 패턴 |
| **심각도** | Low |
| **우선순위** | P4 |
| **설계 섹션** | 11.1 구현 파일 구조 |
| **문제** | Context value 변경 시 모든 Consumer 리렌더링 가능성 |
| **권장 조치** | `useMemo` 메모이제이션, 상태/액션 context 분리 패턴 고려 |

---

### 4.2 보안 관점

#### SEC-001: 탭 title 필드 XSS 인젝션 가능성

| 항목 | 내용 |
|------|------|
| **영역** | OWASP (A03:2021 Injection) |
| **심각도** | High |
| **우선순위** | P1 |
| **설계 섹션** | 5.2 탭 데이터 구조, 6.1 openTab |
| **문제** | `title: string` 필드에 악성 스크립트 주입 가능성 |
| **권장 조치** | HTML 태그 허용 불가 정책 명시, React JSX 기본 이스케이프 활용, CSP 헤더 적용 |

#### SEC-002: 탭 path 필드 경로 조작 가능성

| 항목 | 내용 |
|------|------|
| **영역** | OWASP (A01:2021 Broken Access Control) |
| **심각도** | High |
| **우선순위** | P1 |
| **설계 섹션** | 5.2 탭 데이터 구조, 6.1 openTab |
| **문제** | `path: string` 검증 로직 미정의로 Open Redirect, JavaScript URI 공격 가능 |
| **권장 조치** | 화이트리스트 기반 검증, `/`로 시작하는 상대 경로만 허용, 프로토콜 포함 URL 차단 |

#### SEC-003: openTab 호출 시 권한 검증 부재

| 항목 | 내용 |
|------|------|
| **영역** | 인증/인가 |
| **심각도** | Critical |
| **우선순위** | P1 |
| **설계 섹션** | 3.2 UC-01 탭 열기, 6.1 탭 액션 API |
| **문제** | 탭 열기 시 해당 화면에 대한 사용자 권한 검증 로직 미정의 |
| **권장 조치** | openTab 함수에 권한 검증 로직 추가, TSK-03 역할-메뉴 매핑 연동, 서버 측 재검증 필수 |

#### SEC-004: Tab params 민감정보 노출 위험

| 항목 | 내용 |
|------|------|
| **영역** | 데이터 보호 |
| **심각도** | High |
| **우선순위** | P1 |
| **설계 섹션** | 5.2 탭 데이터 구조, 7.2 상태 저장 |
| **문제** | `params?: Record<string, unknown>` 필드에 민감정보 저장 시 노출 위험 |
| **권장 조치** | params 저장 금지 데이터 유형 명시, sessionStorage 저장 시 암호화 고려 |

#### SEC-005: 세션 만료 시 탭 상태 처리 미정의

| 항목 | 내용 |
|------|------|
| **영역** | 인증/인가 |
| **심각도** | Medium |
| **우선순위** | P2 |
| **설계 섹션** | 7.2 상태 저장 |
| **문제** | 세션 만료 시 열린 탭들의 상태 처리 방안 미정의 |
| **권장 조치** | 세션 만료 시 모든 탭 상태 클리어, 탭 복원 시 사용자 ID 비교 |

#### SEC-006: sessionStorage 데이터 보호 미흡

| 항목 | 내용 |
|------|------|
| **영역** | 데이터 보호 |
| **심각도** | Medium |
| **우선순위** | P2 |
| **설계 섹션** | 7.2 상태 저장 |
| **문제** | sessionStorage는 XSS 공격 시 전체 데이터 탈취 가능 |
| **권장 조치** | 저장 데이터 최소화, 민감 데이터 암호화, 무결성 검증용 HMAC 추가 |

#### SEC-007: 클라이언트 측 탭 상태 조작 가능성

| 항목 | 내용 |
|------|------|
| **영역** | 클라이언트 보안 |
| **심각도** | Medium |
| **우선순위** | P2 |
| **설계 섹션** | 8.1 핵심 규칙 (BR-02, BR-03) |
| **문제** | 브라우저 콘솔에서 maxTabs 우회, closable=false 탭 강제 닫기 등 조작 가능 |
| **권장 조치** | 중요 비즈니스 로직은 서버 측 재검증 필수, 클라이언트 상태 변경 시 서버 감사 로깅 |

#### SEC-008: 탭 ID 예측 가능성

| 항목 | 내용 |
|------|------|
| **영역** | 클라이언트 보안 |
| **심각도** | Low |
| **우선순위** | P3 |
| **설계 섹션** | 5.2 탭 데이터 구조 |
| **문제** | `id: "work-order-123"` 형태의 예측 가능한 ID 사용으로 열거 공격 가능 |
| **권장 조치** | 탭 ID에 랜덤 요소 추가 (UUID v4), 데이터 접근 시 권한 재검증 |

#### SEC-009: URL 기반 탭 복원 시 인젝션 위험

| 항목 | 내용 |
|------|------|
| **영역** | 클라이언트 보안 |
| **심각도** | Medium |
| **우선순위** | P2 |
| **설계 섹션** | 7.2 상태 저장 (향후 확장 시) |
| **문제** | URL 쿼리 파라미터 기반 탭 복원 시 악의적 payload 주입 가능 |
| **권장 조치** | URL 기반 복원 구현 시 엄격한 입력 검증, JSON 파싱 전 스키마 검증 |

#### SEC-010: 에러 메시지 정보 노출

| 항목 | 내용 |
|------|------|
| **영역** | 데이터 보호 |
| **심각도** | Info |
| **우선순위** | P4 |
| **설계 섹션** | 9.2 에러 표시 방식 |
| **문제** | `console.warn` 출력이 프로덕션에서 시스템 내부 정보 유출 가능 |
| **권장 조치** | 프로덕션 빌드에서 console 출력 제거/난독화, 에러 추적은 APM 도구 활용 |

---

### 4.3 품질/완전성 관점

#### QA-001: PRD 요구사항 "전체/다른 탭 닫기" 누락

| 항목 | 내용 |
|------|------|
| **영역** | 요구사항추적성 |
| **심각도** | High |
| **우선순위** | P2 |
| **설계 섹션** | 6.1 탭 액션 API |
| **문제** | PRD 4.1.1 "탭 닫기 (개별/전체/다른 탭 닫기)" 중 "전체 닫기", "다른 탭 닫기" 기능 누락 |
| **권장 조치** | `closeAllTabs`, `closeOtherTabs` API 추가, 관련 테스트 추가 |

#### QA-002: 010-design.md 체크리스트 오류

| 항목 | 내용 |
|------|------|
| **영역** | 문서일관성 |
| **심각도** | Medium |
| **우선순위** | P3 |
| **설계 섹션** | 12.2 연관 문서 작성 |
| **문제** | 025, 026 문서 작성이 미완료(`[ ]`)로 표시되어 있으나 실제로 작성됨 |
| **권장 조치** | 체크리스트를 `[x]`로 업데이트 |

#### QA-003: 마지막 탭 닫기 단위 테스트 누락

| 항목 | 내용 |
|------|------|
| **영역** | 테스트가능성 |
| **심각도** | Medium |
| **우선순위** | P3 |
| **설계 섹션** | 010-design.md 6.3 |
| **문제** | "마지막 탭 닫기 → activeTabId = null" 동작 검증 테스트 없음 |
| **권장 조치** | `UT-011: 마지막 탭 닫기 시 activeTabId가 null이 됨` 추가 |

#### QA-004: UC-04 상세 정의 누락

| 항목 | 내용 |
|------|------|
| **영역** | 문서일관성 |
| **심각도** | Medium |
| **우선순위** | P3 |
| **설계 섹션** | 3.2 유즈케이스 상세 |
| **문제** | UC-04 (탭 상태 유지) 상세 정의가 없음 |
| **권장 조치** | UC-04의 기본 흐름, 사전/사후 조건 추가 |

#### QA-005: BR-MDI-03 E2E 테스트 누락

| 항목 | 내용 |
|------|------|
| **영역** | 테스트가능성 |
| **심각도** | Low |
| **우선순위** | P4 |
| **설계 섹션** | 025-traceability-matrix.md |
| **문제** | closable=false 탭의 E2E 테스트 미정의 |
| **권장 조치** | UI에서 닫기 버튼 미표시 검증 E2E 테스트 추가 고려 |

#### QA-006: 존재하지 않는 탭 활성화 에러 테스트 누락

| 항목 | 내용 |
|------|------|
| **영역** | 테스트가능성 |
| **심각도** | Low |
| **우선순위** | P4 |
| **설계 섹션** | 9.1 예상 에러 상황 |
| **문제** | "존재하지 않는 탭 활성화 → 콘솔 경고" 검증 테스트 없음 |
| **권장 조치** | `UT-012: 존재하지 않는 탭 ID로 setActiveTab 호출 시 경고` 추가 |

---

## 5. 커버리지 통계

### 5.1 기능 요구사항 (FR) 커버리지

| FR ID | PRD 요구사항 | 설계 매핑 | 테스트 매핑 | 상태 |
|-------|-------------|----------|------------|------|
| FR-MDI-01 | 탭 기반 다중 화면 관리 | ✅ 5.2 | ✅ UT-001,002 / E2E-001 | 커버됨 |
| FR-MDI-02 | 여러 화면 동시 열기 및 전환 | ✅ 6.2 | ✅ UT-003,004 / E2E-002 | 커버됨 |
| FR-MDI-03 | 탭 닫기 (개별) | ✅ 6.3 | ✅ UT-005~007 / E2E-003 | 커버됨 |
| FR-MDI-03-A | 탭 닫기 (전체) | ❌ 누락 | ❌ 누락 | **미커버** |
| FR-MDI-03-B | 탭 닫기 (다른 탭) | ❌ 누락 | ❌ 누락 | **미커버** |
| FR-MDI-04 | 화면 상태 유지 | ✅ UC-04 | ✅ UT-008 / E2E-004 | 커버됨 |
| FR-MDI-05 | 최대 탭 개수 제한 | ✅ BR-02 | ✅ UT-009 / E2E-005 | 커버됨 |

**FR 커버리지: 5/7 (71.4%)**

### 5.2 비즈니스 규칙 (BR) 커버리지

| BR ID | 규칙 | 설계 매핑 | 테스트 매핑 | 상태 |
|-------|------|----------|------------|------|
| BR-MDI-01 | 동일 ID 탭 중복 열기 불가 | ✅ 8.1 | ✅ UT-004 / E2E-002 | 커버됨 |
| BR-MDI-02 | 최대 탭 개수 제한 | ✅ 8.1 | ✅ UT-009 / E2E-005 | 커버됨 |
| BR-MDI-03 | closable=false 탭 닫기 불가 | ✅ 8.1 | ✅ UT-010 | 커버됨 |
| BR-MDI-04 | 탭 전환 시 상태 유지 | ✅ 8.1 | ✅ UT-008 / E2E-004 | 커버됨 |

**BR 커버리지: 4/4 (100%)**

### 5.3 테스트 커버리지

| 테스트 유형 | 정의 수 | 목표 커버리지 |
|------------|---------|--------------|
| 단위 테스트 (UT) | 10 | 90% |
| E2E 테스트 | 5 | 100% 시나리오 |
| 매뉴얼 테스트 (TC) | 4 | 전체 기능 |

---

## 6. 권장 조치 요약

### 6.1 구현 전 필수 보완 (P1)

| # | 이슈 | 조치 |
|---|------|------|
| 1 | SEC-001 | title 필드 HTML 태그 금지 정책 및 이스케이프 규칙 명시 |
| 2 | SEC-002 | path 필드 화이트리스트 검증 규칙 추가 |
| 3 | SEC-003 | openTab 권한 검증 로직 설계 (TSK-03 연동) |
| 4 | SEC-004 | params 필드 민감정보 저장 금지 정책 명시 |

### 6.2 구현 초기 보완 (P2)

| # | 이슈 | 조치 |
|---|------|------|
| 1 | QA-001 | closeAllTabs, closeOtherTabs API 및 테스트 추가 |
| 2 | ARCH-002 | 영속성 어댑터 패턴 설계 추가 |
| 3 | SEC-005~007, SEC-009 | 세션/스토리지/클라이언트 보안 설계 보완 |

### 6.3 구현 중 보완 (P3)

| # | 이슈 | 조치 |
|---|------|------|
| 1 | ARCH-001, ARCH-003 | Context 책임 분리, 액션 확장 전략 |
| 2 | QA-002~004 | 체크리스트 업데이트, UC-04 상세, UT-011 추가 |
| 3 | SEC-008 | 탭 ID UUID 적용 |

### 6.4 선택적 보완 (P4-P5)

- ARCH-004~006: 탭 타입 확장, maxTabs 주입, 리렌더링 최적화
- QA-005~006: E2E/에러 테스트 추가
- SEC-010: 프로덕션 콘솔 출력 제거

---

## 7. 종합 판정

| 항목 | 결과 |
|------|------|
| **종합 평가** | **WARN** |
| **승인 조건** | P1 이슈 4건 해결 방안을 설계 문서에 반영 필요 |

### 판정 근거

1. **아키텍처**: 기본 구조는 양호하나 확장성 설계 보완 필요 (WARN)
2. **보안**: Critical 1건, High 3건의 보안 이슈 존재 (WARN)
3. **품질**: PRD 요구사항 2건 누락으로 추적성 미흡 (WARN)
4. **테스트**: 정의된 범위 내에서는 양호 (PASS)

### 다음 단계

1. P1 보안 이슈 해결 방안을 010-design.md에 "보안 요구사항" 섹션으로 추가
2. closeAllTabs, closeOtherTabs API를 6.1 섹션에 추가
3. 관련 테스트 케이스를 026-test-specification.md에 추가
4. 보완 완료 후 `/wf:apply` 실행

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-20 | claude-1 | 최초 작성 |

---

---

## 8. 적용 결과 (wf:apply)

**적용 일자**: 2026-01-20
**적용자**: Claude

### 8.1 적용 판단 요약

| 판단 | 개수 | 이슈 목록 |
|------|------|-----------|
| ✅ 적용 | 9건 | SEC-001, SEC-002, SEC-004, QA-001, QA-002, QA-003, QA-004 |
| 📝 조정 적용 | 3건 | SEC-003 (권한 검증 인터페이스만), ARCH-002 (어댑터 패턴 명시), SEC-006 (저장 데이터 최소화) |
| ⏸️ 보류 | 12건 | ARCH-001, ARCH-003~006, SEC-005, SEC-007~010, QA-005~006 |

### 8.2 적용 상세

#### P1 이슈 (4건 → 100% 처리)

| 이슈 | 적용 내용 |
|------|----------|
| SEC-001 | 9. 보안 요구사항 섹션에 SEC-01: title 필드 XSS 방지 정책 추가 |
| SEC-002 | 9. 보안 요구사항 섹션에 SEC-02: path 필드 경로 검증 정책 추가 |
| SEC-003 | 📝 조정: openTab 권한 검증 인터페이스 추가 (TSK-03 연동은 향후) |
| SEC-004 | 9. 보안 요구사항 섹션에 SEC-04: params 민감정보 정책 추가 |

#### P2 이슈 (5건 → 3건 적용, 2건 보류)

| 이슈 | 적용/보류 | 내용 |
|------|----------|------|
| QA-001 | ✅ 적용 | closeAllTabs, closeOtherTabs API 추가 (6.1, 6.4) |
| ARCH-002 | 📝 조정 | 영속성 어댑터 인터페이스 패턴 추가 (7.3) |
| SEC-005 | ⏸️ 보류 | 세션 만료 처리는 인증 모듈(TSK 범위 외) |
| SEC-006 | 📝 조정 | 저장 데이터 최소화 정책 반영 (7.3) |
| SEC-007 | ⏸️ 보류 | 서버 측 재검증은 TSK 범위 외 |

#### P3 이슈 (6건 → 4건 적용, 2건 보류)

| 이슈 | 적용/보류 | 내용 |
|------|----------|------|
| ARCH-001 | ⏸️ 보류 | 구현 단계 설계 판단 |
| ARCH-003 | ✅ 적용 | QA-001 적용으로 해결 |
| QA-002 | ✅ 적용 | 체크리스트 [x]로 업데이트 |
| QA-003 | ✅ 적용 | UT-011 추가 |
| QA-004 | ✅ 적용 | UC-04 상세 정의 추가 |
| SEC-008 | ⏸️ 보류 | 클라이언트 상태로 보안 중요도 낮음 |

### 8.3 수정된 문서

| 문서 | 변경 내용 |
|------|----------|
| 010-design.md | 보안 요구사항 섹션(9장) 추가, API 추가(6.1, 6.4), 영속성 어댑터(7.3), UC-04 상세, 체크리스트 업데이트 |
| 025-traceability-matrix.md | FR-MDI-03-A, FR-MDI-03-B 추가, UT-011~013, E2E-006~007 추가 |
| 026-test-specification.md | UT-011~013, E2E-006~007 테스트 케이스 상세 추가 |

---

<!--
Task: TSK-02-01 MDI 상태 관리
Review Type: design-review
Reviewer: claude-1
Created: 2026-01-20
Applied: 2026-01-20
-->
