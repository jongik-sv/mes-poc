# 요구사항 추적성 매트릭스 (025-traceability-matrix.md)

**Template Version:** 1.0.0 — **Last Updated:** 2026-01-20

> **목적**: PRD → 설계 → 테스트 양방향 추적

---

## 0. 문서 메타데이터

| 항목 | 내용 |
|------|------|
| Task ID | TSK-03-04 |
| Task명 | 즐겨찾기 메뉴 |
| PRD 참조 | PRD 4.1.1 동적 메뉴 시스템 - 즐겨찾기 메뉴 기능 |
| 설계 문서 참조 | `010-design.md` |
| 테스트 명세 참조 | `026-test-specification.md` |
| 작성일 | 2026-01-20 |
| 작성자 | AI |

---

## 1. 기능 요구사항 추적 (FR → 설계 → 테스트)

| 요구사항 ID | PRD 섹션 | 설계 섹션 | 단위 테스트 | E2E 테스트 | 매뉴얼 TC | 상태 |
|-------------|----------|----------|-------------|------------|-----------|------|
| FR-001 | 4.1.1 즐겨찾기 추가 | UC-01, 5.1 | UT-001, UT-002 | E2E-001 | TC-001 | 설계완료 |
| FR-002 | 4.1.1 즐겨찾기 제거 | UC-02, 5.1 | UT-003, UT-004 | E2E-002 | TC-002 | 설계완료 |
| FR-003 | 4.1.1 빠른 메뉴 표시 | UC-03, 5.2 | UT-005, UT-006 | E2E-003 | TC-003 | 설계완료 |
| FR-004 | 4.1.1 즐겨찾기 영속성 | 7.2, 8.1 | UT-007, UT-008 | E2E-004 | TC-004 | 설계완료 |

### 1.1 요구사항별 상세 매핑

#### FR-001: 즐겨찾기 추가 기능

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| **PRD** | prd.md | 4.1.1 | 메뉴 항목에서 즐겨찾기 토글 버튼으로 추가 |
| **설계** | 010-design.md | UC-01, 5.1 | 사이드바 메뉴에서 별 아이콘(☆) 클릭으로 즐겨찾기 추가 |
| **단위 테스트** | 026-test-specification.md | 2.1 | UT-001: FavoriteToggle 렌더링, UT-002: 추가 동작 |
| **E2E 테스트** | 026-test-specification.md | 3.1 | E2E-001: 즐겨찾기 추가 시나리오 |

**설계 상세:**
- 화면: 사이드바 메뉴 - 즐겨찾기 토글 (화면 1)
- 컴포넌트: FavoriteToggle (별 아이콘 버튼)
- 인터랙션: 호버 시 아이콘 표시 → 클릭 시 토글 → 토스트 메시지
- 피드백: "즐겨찾기에 추가되었습니다" 성공 토스트

#### FR-002: 즐겨찾기 제거 기능

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| **PRD** | prd.md | 4.1.1 | 즐겨찾기 토글 버튼으로 제거 |
| **설계** | 010-design.md | UC-02, 5.1 | 채워진 별 아이콘(★) 클릭으로 즐겨찾기 제거 |
| **단위 테스트** | 026-test-specification.md | 2.1 | UT-003: 제거 동작, UT-004: 상태 업데이트 |
| **E2E 테스트** | 026-test-specification.md | 3.1 | E2E-002: 즐겨찾기 제거 시나리오 |

**설계 상세:**
- 화면: 사이드바 메뉴 - 즐겨찾기 토글 (화면 1)
- 컴포넌트: FavoriteToggle (별 아이콘 버튼)
- 인터랙션: 채워진 별(★) 클릭 → 빈 별(☆)로 변경 → 토스트 메시지
- 피드백: "즐겨찾기에서 제거되었습니다" 성공 토스트

#### FR-003: 빠른 메뉴 표시

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| **PRD** | prd.md | 4.1.1 | 헤더의 빠른 메뉴에서 즐겨찾기 목록 드롭다운 |
| **설계** | 010-design.md | UC-03, 5.2 | 헤더 빠른 메뉴 드롭다운에서 즐겨찾기 목록 표시 |
| **단위 테스트** | 026-test-specification.md | 2.1 | UT-005: QuickMenu 렌더링, UT-006: 드롭다운 동작 |
| **E2E 테스트** | 026-test-specification.md | 3.1 | E2E-003: 빠른 메뉴에서 화면 열기 |

**설계 상세:**
- 화면: 헤더 빠른 메뉴 드롭다운 (화면 2)
- 컴포넌트: QuickMenu (드롭다운 컴포넌트)
- 인터랙션: 버튼 클릭 → 드롭다운 표시 → 메뉴 클릭 → MDI 탭 열기
- 빈 상태: "즐겨찾기한 메뉴가 없습니다" 메시지 + 힌트

#### FR-004: 즐겨찾기 영속성

| 설계 단계 | 문서 | 섹션 | 구현 항목 |
|----------|------|------|----------|
| **PRD** | prd.md | 4.1.1 | 새로고침 후에도 즐겨찾기 유지 (localStorage) |
| **설계** | 010-design.md | 7.2, 8.1 | localStorage에 사용자별 즐겨찾기 저장 |
| **단위 테스트** | 026-test-specification.md | 2.1 | UT-007: localStorage 저장, UT-008: 로드 |
| **E2E 테스트** | 026-test-specification.md | 3.1 | E2E-004: 새로고침 후 유지 확인 |

**설계 상세:**
- 데이터 구조: `FavoriteData { userId, menuIds[], updatedAt }`
- 저장 키: `mes-favorites-{userId}`
- 훅: `useFavorites()` 커스텀 훅으로 상태 관리
- 동기화: storage 이벤트로 다중 탭 동기화

---

## 2. 비즈니스 규칙 추적 (BR → 구현 → 검증)

| 규칙 ID | PRD 출처 | 설계 섹션 | 구현 위치(개념) | 단위 테스트 | 검증 방법 | 상태 |
|---------|----------|----------|-----------------|-------------|-----------|------|
| BR-001 | 4.1.1 | 8.1, 7.4 | useFavorites.ts | UT-009 | 최대 10개 초과 시 경고 확인 | 설계완료 |
| BR-002 | 4.1.1 | 7.4 | useFavorites.ts | UT-010 | 중복 ID 추가 시 무시 확인 | 설계완료 |
| BR-003 | 4.1.1 | 7.2 | useFavorites.ts | UT-011 | 추가 순서대로 배열 유지 확인 | 설계완료 |

### 2.1 비즈니스 규칙별 상세 매핑

#### BR-001: 최대 즐겨찾기 개수 제한 (10개)

| 구분 | 내용 |
|------|------|
| **PRD 원문** | 즐겨찾기는 최대 10개까지 추가 가능 |
| **설계 표현** | menuIds 배열 길이 10개 제한, 초과 시 경고 토스트 |
| **구현 위치** | useFavorites.ts - addFavorite 함수 |
| **검증 방법** | 10개 이상 추가 시도 시 추가 실패 및 경고 메시지 확인 |
| **관련 테스트** | UT-009, E2E-005 |

#### BR-002: 중복 즐겨찾기 방지

| 구분 | 내용 |
|------|------|
| **PRD 원문** | 동일 메뉴 중복 즐겨찾기 불가 |
| **설계 표현** | addFavorite 시 이미 존재하면 무시 (Set 활용 또는 includes 체크) |
| **구현 위치** | useFavorites.ts - addFavorite 함수 |
| **검증 방법** | 동일 메뉴 ID 추가 시도 시 배열 길이 변화 없음 확인 |
| **관련 테스트** | UT-010 |

#### BR-003: 즐겨찾기 순서 유지 (추가 순서)

| 구분 | 내용 |
|------|------|
| **PRD 원문** | 즐겨찾기는 추가된 순서대로 표시 |
| **설계 표현** | menuIds 배열에 push로 추가, 순서 변경 없음 |
| **구현 위치** | useFavorites.ts - menuIds 배열 관리 |
| **검증 방법** | 여러 메뉴 추가 후 추가 순서대로 배열에 저장 확인 |
| **관련 테스트** | UT-011, E2E-006 |

---

## 3. 테스트 역추적 매트릭스

| 테스트 ID | 테스트 유형 | 검증 대상 요구사항 | 검증 대상 비즈니스 규칙 | 상태 |
|-----------|------------|-------------------|----------------------|------|
| UT-001 | 단위 | FR-001 | - | 미실행 |
| UT-002 | 단위 | FR-001 | - | 미실행 |
| UT-003 | 단위 | FR-002 | - | 미실행 |
| UT-004 | 단위 | FR-002 | - | 미실행 |
| UT-005 | 단위 | FR-003 | - | 미실행 |
| UT-006 | 단위 | FR-003 | - | 미실행 |
| UT-007 | 단위 | FR-004 | - | 미실행 |
| UT-008 | 단위 | FR-004 | - | 미실행 |
| UT-009 | 단위 | - | BR-001 | 미실행 |
| UT-010 | 단위 | - | BR-002 | 미실행 |
| UT-011 | 단위 | - | BR-003 | 미실행 |
| E2E-001 | E2E | FR-001 | - | 미실행 |
| E2E-002 | E2E | FR-002 | - | 미실행 |
| E2E-003 | E2E | FR-003 | - | 미실행 |
| E2E-004 | E2E | FR-004 | - | 미실행 |
| E2E-005 | E2E | FR-001 | BR-001 | 미실행 |
| E2E-006 | E2E | FR-003 | BR-003 | 미실행 |
| TC-001 | 매뉴얼 | FR-001 | - | 미실행 |
| TC-002 | 매뉴얼 | FR-002 | - | 미실행 |
| TC-003 | 매뉴얼 | FR-003 | - | 미실행 |
| TC-004 | 매뉴얼 | FR-004 | - | 미실행 |

### 3.1 테스트별 검증 내용

| 테스트 ID | 테스트명 | 검증 내용 |
|-----------|---------|----------|
| UT-001 | FavoriteToggle 렌더링 | 별 아이콘 컴포넌트 정상 렌더링 확인 |
| UT-002 | 즐겨찾기 추가 동작 | 빈 별 클릭 시 addFavorite 호출 확인 |
| UT-003 | 즐겨찾기 제거 동작 | 채워진 별 클릭 시 removeFavorite 호출 확인 |
| UT-004 | 상태 업데이트 | 제거 후 isFavorite 상태 false 확인 |
| UT-005 | QuickMenu 렌더링 | 드롭다운 컴포넌트 정상 렌더링 확인 |
| UT-006 | 드롭다운 동작 | 버튼 클릭 시 드롭다운 열림/닫힘 확인 |
| UT-007 | localStorage 저장 | 즐겨찾기 추가 시 localStorage 저장 확인 |
| UT-008 | localStorage 로드 | 페이지 로드 시 저장된 즐겨찾기 복원 확인 |
| UT-009 | 최대 개수 제한 | 10개 초과 추가 시 에러 반환 확인 |
| UT-010 | 중복 방지 | 중복 ID 추가 시 무시 확인 |
| UT-011 | 순서 유지 | 추가 순서대로 배열 저장 확인 |
| E2E-001 | 즐겨찾기 추가 시나리오 | 사이드바에서 즐겨찾기 추가 전체 흐름 |
| E2E-002 | 즐겨찾기 제거 시나리오 | 사이드바에서 즐겨찾기 제거 전체 흐름 |
| E2E-003 | 빠른 메뉴 화면 열기 | 헤더 빠른 메뉴에서 화면 열기 전체 흐름 |
| E2E-004 | 새로고침 후 유지 | 즐겨찾기 추가 후 새로고침 시 유지 확인 |
| E2E-005 | 최대 개수 제한 E2E | 10개 초과 추가 시도 시 경고 메시지 확인 |
| E2E-006 | 순서 유지 E2E | 여러 메뉴 추가 후 표시 순서 확인 |
| TC-001 | 즐겨찾기 추가 매뉴얼 | 수동 테스트 - 즐겨찾기 추가 확인 |
| TC-002 | 즐겨찾기 제거 매뉴얼 | 수동 테스트 - 즐겨찾기 제거 확인 |
| TC-003 | 빠른 메뉴 매뉴얼 | 수동 테스트 - 빠른 메뉴 동작 확인 |
| TC-004 | 영속성 매뉴얼 | 수동 테스트 - 새로고침 후 유지 확인 |

---

## 4. 화면 추적

| 설계 화면 | 컴포넌트 | 경로 | 요구사항 |
|----------|----------|------|----------|
| 사이드바 메뉴 - 즐겨찾기 토글 | FavoriteToggle | `components/common/FavoriteToggle.tsx` | FR-001, FR-002 |
| 헤더 빠른 메뉴 드롭다운 | QuickMenu | `components/layout/QuickMenu.tsx` | FR-003 |
| 사이드바 (기존) | Sidebar | `components/layout/Sidebar.tsx` | FR-001, FR-002 |
| 헤더 (기존) | Header | `components/layout/Header.tsx` | FR-003 |

### 4.1 화면-컴포넌트 매핑

```
┌─────────────────────────────────────────────────────────────────┐
│ HEADER (Header.tsx)                                              │
├─────────────────────────────────────────────────────────────────┤
│  [Logo]  [★ QuickMenu.tsx ▼]  브레드크럼         ...             │
│          └─────────────────┐                                     │
│          │ FavoriteMenu    │ ← FR-003: 빠른 메뉴 표시           │
│          │ 드롭다운 목록    │                                    │
│          └─────────────────┘                                     │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────┐
│ SIDEBAR (Sidebar.tsx)            │
├─────────────────────────────────┤
│  📁 메뉴1                        │
│  ├─ 📄 화면1  [FavoriteToggle]  │ ← FR-001, FR-002
│  └─ 📄 화면2  [FavoriteToggle]  │
└─────────────────────────────────┘
```

### 4.2 컴포넌트 상세 매핑

| 컴포넌트 | 역할 | 요구사항 | 비즈니스 규칙 |
|----------|------|----------|--------------|
| FavoriteToggle | 즐겨찾기 추가/제거 버튼 | FR-001, FR-002 | BR-001, BR-002 |
| QuickMenu | 빠른 메뉴 드롭다운 | FR-003 | BR-003 |
| useFavorites (훅) | 즐겨찾기 상태 관리 | FR-004 | BR-001, BR-002, BR-003 |

---

## 5. 데이터 모델 추적

| 설계 엔티티 | 상태 타입 | 저장 위치 | 관련 요구사항 |
|------------|----------|----------|--------------|
| FavoriteData | `{ userId: number, menuIds: number[], updatedAt: string }` | localStorage | FR-004 |
| FavoriteState | `{ favorites: number[], isLoading: boolean, error?: string }` | React State (Zustand) | FR-001~004 |
| MenuItem | `{ id, code, name, path, icon, parentId, sortOrder, children? }` | API 응답 (캐시) | FR-003 |

### 5.1 데이터 흐름

```
[localStorage]                 [React State]              [UI]
     │                              │                       │
     │ ── 앱 시작 시 로드 ────────→│                       │
     │                              │ ──── 렌더링 ────────→│
     │                              │                       │
     │                              │ ←── 즐겨찾기 토글 ───│
     │ ←── 저장 ──────────────────│                       │
     │                              │ ──── 리렌더링 ─────→│
```

---

## 6. 인터페이스 추적

> 이 Task는 백엔드 API가 없음 (localStorage 기반 프론트엔드 기능)

| 인터페이스 | 유형 | 관련 요구사항 |
|-----------|------|--------------|
| localStorage.getItem/setItem | 브라우저 API | FR-004 |
| storage 이벤트 | 브라우저 이벤트 | FR-004 (다중 탭 동기화) |

---

## 7. 유즈케이스-요구사항 매핑

| 유즈케이스 ID | 유즈케이스명 | 관련 FR | 관련 BR |
|--------------|-------------|---------|---------|
| UC-01 | 메뉴 즐겨찾기 추가 | FR-001, FR-004 | BR-001, BR-002 |
| UC-02 | 메뉴 즐겨찾기 제거 | FR-002, FR-004 | - |
| UC-03 | 빠른 메뉴에서 즐겨찾기 열기 | FR-003 | BR-003 |
| UC-04 | 사이드바에서 즐겨찾기 열기 | FR-001, FR-002 | - |

---

## 8. 추적성 검증 요약

### 8.1 커버리지 통계

| 구분 | 총 항목 | 매핑 완료 | 미매핑 | 커버리지 |
|------|---------|----------|--------|---------|
| 기능 요구사항 (FR) | 4 | 4 | 0 | **100%** |
| 비즈니스 규칙 (BR) | 3 | 3 | 0 | **100%** |
| 유즈케이스 (UC) | 4 | 4 | 0 | **100%** |
| 단위 테스트 (UT) | 11 | 11 | 0 | **100%** |
| E2E 테스트 | 6 | 6 | 0 | **100%** |
| 매뉴얼 테스트 (TC) | 4 | 4 | 0 | **100%** |

### 8.2 요구사항별 테스트 커버리지

| 요구사항 ID | 단위 테스트 | E2E 테스트 | 매뉴얼 TC | 총 커버리지 |
|-------------|------------|------------|-----------|------------|
| FR-001 | UT-001, UT-002 | E2E-001, E2E-005 | TC-001 | 5 |
| FR-002 | UT-003, UT-004 | E2E-002 | TC-002 | 4 |
| FR-003 | UT-005, UT-006 | E2E-003, E2E-006 | TC-003 | 5 |
| FR-004 | UT-007, UT-008 | E2E-004 | TC-004 | 4 |

### 8.3 비즈니스 규칙별 테스트 커버리지

| 규칙 ID | 단위 테스트 | E2E 테스트 | 총 커버리지 |
|---------|------------|------------|------------|
| BR-001 | UT-009 | E2E-005 | 2 |
| BR-002 | UT-010 | - | 1 |
| BR-003 | UT-011 | E2E-006 | 2 |

### 8.4 미매핑 항목

| 구분 | ID | 설명 | 미매핑 사유 |
|------|-----|------|-----------|
| - | - | - | 모두 매핑 완료 |

### 8.5 식별된 위험 요소

| 위험 ID | 설명 | 영향도 | 완화 방안 |
|---------|------|--------|----------|
| R-001 | localStorage 용량 제한 | 낮음 | 즐겨찾기 개수 10개 제한으로 완화 |
| R-002 | 비공개 브라우징 모드 | 낮음 | 세션 동안 메모리에 유지하도록 폴백 |
| R-003 | 다중 탭 동기화 | 중간 | storage 이벤트 리스너로 해결 |

---

## 관련 문서

| 문서 유형 | 경로 | 설명 |
|----------|------|------|
| 설계 문서 | `010-design.md` | 즐겨찾기 메뉴 상세 설계 |
| 테스트 명세 | `026-test-specification.md` | 단위/E2E/매뉴얼 테스트 상세 |
| PRD | `.orchay/projects/mes-portal/prd.md` | 4.1.1 동적 메뉴 시스템 |
| TRD | `.orchay/projects/mes-portal/trd.md` | 2.3 MVP 백엔드 범위 |
| 의존 태스크 | `TSK-03-03` | 메뉴 API 엔드포인트 |
| 의존 태스크 | `TSK-01-02` | 헤더 컴포넌트 (빠른 메뉴 위치) |
| 의존 태스크 | `TSK-02-01` | MDI 상태 관리 (openTab 함수) |

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-20 | AI | 최초 작성 |
