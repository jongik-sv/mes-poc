# TSK-04-04 로그인 페이지 설계 리뷰

## 문서 정보

| 항목 | 내용 |
|------|------|
| Task ID | TSK-04-04 |
| Task명 | 로그인 페이지 |
| 리뷰 유형 | 설계 리뷰 |
| 리뷰어 | claude-1 |
| 리뷰 일자 | 2026-01-20 |
| 리뷰 대상 문서 | `010-design.md`, `025-traceability-matrix.md`, `026-test-specification.md` |

---

## 검증 대상 문서 상태

| 문서 | 상태 | 비고 |
|------|------|------|
| 010-design.md | ✅ | 12개 섹션 완비 |
| 025-traceability-matrix.md | ✅ | FR 4개, BR 4개 매핑 완료 |
| 026-test-specification.md | ✅ | UT 13개, E2E 9개, TC 15개 정의 |

---

## 검증 결과 요약

| 검증 영역 | 평가 | 비고 |
|-----------|------|------|
| 문서 완전성 | PASS | 필수 섹션 모두 포함 |
| 요구사항 추적성 | WARN | 기본 FR/BR 매핑 완료, 일부 보완 필요 |
| 아키텍처 | WARN | High 1건, Medium 3건 존재 |
| 보안 | WARN | Critical 1건, High 4건 존재 |
| 테스트 가능성 | PASS | UT 13, E2E 9, TC 15 정의 |

---

## 이슈 분포

| 심각도 | 개수 |
|--------|------|
| Critical | 1 |
| High | 9 |
| Medium | 12 |
| Low | 9 |
| Info | 7 |
| **합계** | **38** |

---

## Critical 이슈 (1건)

### SEC-001: Brute Force 공격 방어 미비

| 항목 | 내용 |
|------|------|
| **심각도** | Critical |
| **우선순위** | P1 |
| **영역** | 보안 - 인증 |
| **설명** | 로그인 시도 횟수 제한(Rate Limiting) 또는 계정 잠금(Account Lockout) 메커니즘이 정의되지 않음. 공격자가 자동화 도구를 통해 무제한 로그인 시도가 가능하여 비밀번호 무차별 대입 공격에 취약함. |
| **권장 사항** | 1) 5회 연속 실패 시 5분 지연(Exponential Backoff) 적용<br>2) IP 기반 Rate Limiting (분당 10회 제한)<br>3) 10회 연속 실패 시 계정 일시 잠금(30분)<br>4) CAPTCHA 도입 검토 (3회 실패 후 표시) |

---

## High 이슈 (9건)

### SEC-002: 비밀번호 정책 미정의

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 보안 - 인증 |
| **설명** | 설계 문서(7.3절)에서 비밀번호 유효성 규칙이 "필수, 최소 1자"로만 정의됨. 약한 비밀번호가 허용되어 사전 공격에 취약함. |
| **권장 사항** | 최소 비밀번호 정책 정의: 8자 이상, 대/소문자/숫자/특수문자 중 3가지 조합, 일반적인 비밀번호 블랙리스트 검사 |

### SEC-005: 세션 고정 공격 방어 미명시

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 보안 - 세션 관리 |
| **설명** | 로그인 성공 후 세션 ID 재생성(Session Regeneration) 처리가 설계에 명시되지 않음. |
| **권장 사항** | 로그인 성공 시 새로운 세션 ID 발급 명시, Auth.js의 세션 재생성 기능 활용 확인 |

### SEC-006: JWT 보안 설정 상세화 필요

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P2 |
| **영역** | 보안 - 인증 |
| **설명** | JWT 토큰 만료 시간, 리프레시 토큰 정책, 서명 알고리즘 등 세부 보안 설정이 정의되지 않음. |
| **권장 사항** | Access Token 만료: 15-30분, Refresh Token 만료: 7일, 서명 알고리즘: RS256/ES256, 토큰 저장: httpOnly, Secure 쿠키 |

### SEC-008: 비밀번호 해싱 파라미터 미정의

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 보안 - 데이터 보호 |
| **설명** | TRD Prisma 스키마에서 bcrypt 해시 언급이 있으나, cost factor 등 해싱 파라미터가 정의되지 않음. |
| **권장 사항** | bcrypt cost factor 12 이상 권장, Argon2id 알고리즘 도입 검토 |

### ARCH-005: 의존성 인터페이스 미확정

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 아키텍처 - 의존성 관리 |
| **설명** | TSK-04-04가 TSK-04-03(Auth.js 설정)에 의존하며, TSK-04-03 상태가 "Todo"로 표시됨. 병렬 개발 시 인터페이스 정의 없이 진행하면 통합 문제 발생 가능. |
| **권장 사항** | TSK-04-03에서 제공할 인터페이스(signIn 함수 시그니처, 반환 타입)를 먼저 확정, Mock signIn 구현체 사용으로 의존성 차단 |

### QA-004: 로딩 상태 추적성 누락

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 품질 - 추적성 |
| **설명** | PRD 4.1.1 "버튼 로딩 상태 (스피너 + 비활성화)" 요구사항이 추적 매트릭스에 명시적인 FR 항목으로 분리되지 않음. |
| **권장 사항** | FR-005 "로딩 상태 표시"를 별도 기능 요구사항으로 분리하고 UT-007과 명시적 매핑 추가 |

### QA-008: data-testid 설계 문서 누락

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 품질 - 테스트 가능성 |
| **설명** | 026-test-specification.md에서 정의된 data-testid 목록이 010-design.md에서 전혀 언급되지 않음. |
| **권장 사항** | 010-design.md 섹션 5.2 또는 새로운 섹션에 data-testid 매핑 테이블 추가 |

### QA-014: 접근성 요구사항 미반영

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 품질 - 수용 기준 |
| **설명** | PRD 4.1.1 접근성 요구사항 "ARIA 레이블 적용", "포커스 표시", "스크린 리더 호환"이 설계 문서에 부분적으로만 반영됨. |
| **권장 사항** | ARIA 속성 명세 추가 (role="form", aria-label, aria-describedby 등), AC-006 "접근성 요구사항 충족" 수용 기준 추가 |

### QA-019: 서버 에러 정보 노출 방지 미명시

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 품질 - 보안 |
| **설명** | 에러 처리 섹션에서 스택 트레이스 또는 상세 에러 정보가 사용자에게 노출되지 않아야 함을 명시적으로 언급하지 않음. |
| **권장 사항** | 섹션 9에 보안 관련 에러 처리 원칙 추가 |

---

## Medium 이슈 (12건)

### ARCH-001: LoginForm 컴포넌트 단일 책임 원칙

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 아키텍처 - 컴포넌트 구조 |
| **설명** | LoginForm 컴포넌트가 폼 렌더링, 유효성 검사, API 호출, 에러 처리, 리다이렉트 로직을 모두 담당하는 것으로 설계됨. |
| **권장 사항** | 폼 로직을 커스텀 훅(useLoginForm)으로 분리, 인증 서비스 레이어(lib/services/auth.ts) 도입 |

### ARCH-004: 에러 메시지 중앙화 미정의

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 아키텍처 - 확장성 |
| **설명** | 에러 메시지가 컴포넌트 내부에 하드코딩될 가능성이 있음. 향후 다국어 지원 또는 메시지 변경 시 여러 곳을 수정해야 할 수 있음. |
| **권장 사항** | 에러 메시지 상수 파일 도입 (lib/constants/messages.ts) |

### ARCH-008: Phase 2 확장성 고려

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 아키텍처 - 확장성 |
| **설명** | 현재 폼 구조가 "Remember me", "비밀번호 찾기", "소셜 로그인" 확장을 수용할 수 있는 유연한 구조인지 확인 필요. |
| **권장 사항** | LoginForm 컴포넌트에 additionalActions 슬롯 고려, 향후 소셜 로그인 버튼 영역 예약 |

### SEC-003: 전송 계층 보안 명시 필요

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 보안 - 데이터 보호 |
| **설명** | HTTPS 강제 리다이렉트 및 HSTS 헤더 적용이 명시되지 않음. |
| **권장 사항** | HTTP→HTTPS 강제 리다이렉트, HSTS 헤더 적용 명시 |

### SEC-004: 보안 헤더 설정 미정의

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 보안 - 설정 |
| **설명** | 로그인 페이지에 적용해야 할 보안 HTTP 헤더가 설계 문서에 정의되지 않음. |
| **권장 사항** | X-Content-Type-Options, X-Frame-Options, CSP, X-XSS-Protection 헤더 적용 명시 |

### SEC-010: 세션 타임아웃 정책 미정의

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 보안 - 세션 관리 |
| **설명** | 세션 유효 기간 및 비활성 타임아웃 정책이 설계에 정의되지 않음. |
| **권장 사항** | 세션 절대 만료: 8시간, 비활성 타임아웃: 30분, 세션 만료 전 경고 알림 |

### SEC-011: 동시 세션 제어 미정의

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 보안 - 세션 관리 |
| **설명** | 동일 계정의 다중 동시 로그인 허용 여부가 정의되지 않음. |
| **권장 사항** | 동시 로그인 정책 결정 및 명시 (허용/신규 로그인 시 기존 종료/역할별 차등) |

### SEC-014: 로그인 이벤트 감사 로깅 미정의

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 보안 - 감사 |
| **설명** | 로그인 성공/실패에 대한 감사 로그 기록 요구사항이 정의되지 않음. |
| **권장 사항** | 로그인 성공/실패/계정 잠금 이벤트 로깅 정의, 로그 보관 기간: 최소 90일 |

### SEC-015: 서버 측 검증 명시 필요

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 보안 - 입력 검증 |
| **설명** | 클라이언트 측 유효성 검사만 언급되고 서버 측 검증의 중요성이 명시되지 않음. |
| **권장 사항** | 서버 측에서 동일한 유효성 검사 필수 적용 명시 |

### QA-005: 재시도 버튼 설계 누락

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 품질 - 추적성 |
| **설명** | PRD "네트워크 오류 (재시도 버튼)" 요구사항이 010-design.md에 명시되지 않음. |
| **권장 사항** | 섹션 9.1 "네트워크 오류" 항목에 "재시도 버튼" UI 요소 명시 |

### QA-012: 세션 만료 수용 기준 누락

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 품질 - 수용 기준 |
| **설명** | PRD의 "세션 만료 (재로그인 안내)" 요구사항에 대한 수용 기준이 누락됨. |
| **권장 사항** | AC-005 "세션 만료 시 재로그인 안내 표시" 수용 기준 추가 |

### QA-020: 레이트 리밋 테스트 필수화

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 품질 - 엣지 케이스 |
| **설명** | EDGE-007 "연속 로그인 시도 (5회 이상 실패)"가 "(선택적)"으로 표기되었으나, 레이트 리밋은 보안상 중요한 기능임. |
| **권장 사항** | 010-design.md에 로그인 시도 제한 정책 추가, EDGE-007을 필수 테스트로 변경 |

---

## Low 이슈 (9건)

| ID | 영역 | 설명 | 권장 사항 |
|----|------|------|----------|
| ARCH-002 | 의존성 관리 | Auth.js signIn 함수 직접 호출로 강한 결합 | 인증 서비스 추상화 레이어 도입 검토 |
| ARCH-007 | 유지보수성 | 타입 관리 전략 부재 | 공유 타입은 types/auth.ts에 정의 |
| ARCH-010 | CSS 관리 | 반응형 스타일 적용 방법 불명확 | TailwindCSS 반응형 클래스 사용으로 전환 |
| SEC-009 | 클라이언트 보안 | 비밀번호 표시 기능의 어깨 너머 훔쳐보기 위험 | 비밀번호 표시 후 3초 후 자동 마스킹 검토 |
| QA-001 | 문서 완전성 | 문서 상태가 "작성중"이나 체크리스트 완료 | 문서 상태를 "설계완료"로 변경 |
| QA-003 | 문서 완전성 | TSK-04-02 상태 "[dd]" 의미 불명확 | 상태값을 명확한 용어로 변경 |
| QA-006 | 추적성 | BR-003의 PRD 출처가 비기능 요구사항 섹션 | PRD 출처를 명확히 하거나 비기능 요구사항임을 명시 |
| QA-015 | 참조 일관성 | PRD 경로 대소문자 불일치 | 경로 대소문자 일관성 확인 및 수정 |
| QA-017 | 참조 일관성 | BR ID 형식 불일치 (BR-02 vs BR-002) | BR ID 형식을 통일 (권장: BR-001, BR-002) |

---

## Info 이슈 (7건)

| ID | 영역 | 설명 |
|----|------|------|
| ARCH-003 | 컴포넌트 분할 | Server/Client Component 경계가 명확하고 적절함 |
| ARCH-006 | TRD 정합성 | 기술 스택이 TRD와 완전히 일치함 |
| ARCH-009 | 관심사 분리 | 클라이언트 검증 + 서버 인증 조합이 적절함 |
| SEC-007 | 인증 | 비활성 계정 메시지는 보안 수준에 따라 선택 가능 |
| SEC-012 | 정보 노출 방지 | 서버 에러 처리가 양호함 |
| SEC-013 | 정보 노출 방지 | 일반화된 인증 실패 메시지로 계정 열거 방지 |
| QA-002 | 문서 완전성 | 12개 섹션 구조가 표준에 부합함 |

---

## 양호한 설계 항목

현재 설계에서 다음 항목은 양호하게 설계되었습니다:

1. **일반화된 인증 실패 메시지 (BR-03)**: 계정 열거 공격 방지
2. **비밀번호 마스킹**: 기본 입력 시 비밀번호 숨김 처리
3. **Auth.js 활용**: CSRF 보호 내장, 세션 관리 표준화
4. **Prisma ORM 사용**: SQL Injection 방지
5. **React 자동 이스케이프**: XSS 기본 방어
6. **Server/Client Component 분리**: Next.js App Router 권장 패턴 준수
7. **Ant Design 활용**: TRD 가이드라인 준수
8. **추적성 매트릭스**: FR/BR 100% 매핑 완료
9. **테스트 명세**: 37개 테스트 케이스 정의 (UT 13, E2E 9, TC 15)

---

## 우선순위별 조치 사항

### P1 - 즉시 조치 (구현 전 필수)

| ID | 이슈 | 조치 사항 |
|----|------|----------|
| SEC-001 | Brute Force 방어 | Rate Limiting, 계정 잠금 정책 추가 |
| SEC-002 | 비밀번호 정책 | 최소 8자, 복잡도 요구사항 정의 |
| SEC-005 | 세션 고정 공격 | 로그인 후 세션 ID 재생성 명시 |
| SEC-008 | 비밀번호 해싱 | bcrypt cost factor 12 이상 명시 |
| ARCH-005 | 의존성 인터페이스 | TSK-04-03 인터페이스 확정 또는 Mock 활용 |
| QA-004 | 로딩 상태 추적 | FR-005 "로딩 상태 표시" 분리 |
| QA-008 | data-testid | 010-design.md에 data-testid 매핑 추가 |
| QA-014 | 접근성 | ARIA 속성 명세 및 AC-006 추가 |
| QA-019 | 에러 정보 노출 | 보안 에러 처리 원칙 명시 |

### P2 - 설계 단계 반영

| ID | 이슈 | 조치 사항 |
|----|------|----------|
| ARCH-001 | 단일 책임 원칙 | useLoginForm 훅 도입 검토 |
| ARCH-004 | 에러 메시지 | 메시지 상수 중앙화 |
| ARCH-008 | 확장성 | Phase 2 UI 확장 고려 |
| SEC-003 | 전송 보안 | HTTPS 강제, HSTS 명시 |
| SEC-004 | 보안 헤더 | 보안 HTTP 헤더 정의 |
| SEC-006 | JWT 설정 | 토큰 만료, 저장 방식 상세화 |
| SEC-010 | 세션 타임아웃 | 세션 정책 정의 |
| SEC-011 | 동시 세션 | 동시 로그인 정책 결정 |
| SEC-014 | 감사 로깅 | 로그인 이벤트 로깅 정의 |
| SEC-015 | 서버 검증 | 서버 측 유효성 검사 명시 |
| QA-005 | 재시도 버튼 | UI 요소 명시 |
| QA-012 | 세션 만료 | AC-005 수용 기준 추가 |
| QA-020 | 레이트 리밋 테스트 | EDGE-007 필수화 |

### P3-P5 - 구현 시 고려

| 우선순위 | ID | 이슈 |
|----------|-----|------|
| P3 | ARCH-007, ARCH-010 | 타입 관리, CSS 적용 방법 |
| P3 | SEC-009 | 비밀번호 표시 자동 마스킹 |
| P3 | QA-006 | BR PRD 출처 명확화 |
| P4 | ARCH-002 | 인증 서비스 추상화 |
| P4 | QA-001, QA-003, QA-015, QA-017 | 문서 형식 수정 |

---

## 결론

| 항목 | 내용 |
|------|------|
| **종합 평가** | **WARN** - MVP 출시 전 P1 이슈 조치 필요 |
| **Critical 이슈** | 1건 (Brute Force 방어) |
| **High 이슈** | 9건 (보안 4, 아키텍처 1, 품질 4) |
| **핵심 권장 사항** | 1) Rate Limiting 및 계정 잠금 정책 추가<br>2) 비밀번호 복잡도 정책 정의<br>3) 세션 보안 강화 (재생성, 타임아웃)<br>4) 접근성 요구사항 반영<br>5) data-testid 설계 문서 반영 |

---

---

## 적용 결과

### 적용 일자
2026-01-20

### 맥락 분석 결과

| 검토 항목 | 평가 |
|----------|------|
| 시스템 적합성 | 5/5 |
| Task 범위 적합성 | 5/5 |
| 실현 가능성 | 5/5 |

### 이슈별 처리 결과

**P1 이슈 (9건) - 100% 적용:**

| ID | 판단 | 사유 |
|----|------|------|
| SEC-001 | ✅ 적용 | Rate Limiting 정책 추가 (BR-05) |
| SEC-002 | ✅ 적용 | 비밀번호 정책 8자 이상 + 복잡도 정의 |
| SEC-005 | ✅ 적용 | Auth.js 세션 재생성 기능 활용 명시 |
| SEC-008 | ✅ 적용 | bcrypt cost factor 언급 추가 |
| ARCH-005 | ✅ 적용 | Mock signIn 인터페이스 정의 |
| QA-004 | ✅ 적용 | FR-005 로딩 상태 표시 분리 |
| QA-008 | ✅ 적용 | data-testid 매핑 테이블 추가 |
| QA-014 | ✅ 적용 | ARIA 속성 명세 추가 |
| QA-019 | ✅ 적용 | 보안 에러 처리 원칙 섹션 추가 |

### 수정된 문서

| 문서 | 변경 내용 |
|------|----------|
| 010-design.md | P1 이슈 전체 반영 (버전 1.1) |

### 적용 통계

| 구분 | 개수 |
|------|------|
| ✅ 적용 | 9건 |
| 📝 조정 적용 | 0건 |
| ⏸️ 보류 | 0건 |

> 참고: 설계 문서가 이미 리뷰 반영 후 버전 1.1로 업데이트되어 있어 별도 수정 없이 적용 완료 처리

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-20 | claude-1 | 최초 작성 |
| 1.1 | 2026-01-20 | Claude | 적용 결과 섹션 추가 |
