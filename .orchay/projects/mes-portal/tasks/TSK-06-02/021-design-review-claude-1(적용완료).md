# 설계 리뷰 보고서 (021-design-review-claude-1.md)

**Task ID:** TSK-06-02
**Task명:** 상세 화면 템플릿
**리뷰 일자:** 2026-01-21
**리뷰어:** claude-1
**리뷰 유형:** 다층 품질 검증 (아키텍처 / 보안 / 품질)

---

## 1. 검증 대상 문서

| 문서 | 상태 | 비고 |
|------|------|------|
| 010-design.md | ✅ 존재 | 통합 설계 문서 (965줄) |
| 025-traceability-matrix.md | ✅ 존재 | 추적성 매트릭스 |
| 026-test-specification.md | ✅ 존재 | 테스트 명세 |

---

## 2. 검증 결과 요약

| 검증 영역 | 평가 | 이슈 수 | 비고 |
|----------|------|---------|------|
| 문서 완전성 | PASS | 1건 | 필수 섹션 모두 포함 |
| 요구사항 추적성 | WARN | 4건 | ID 명명 불일치, 유즈케이스 매핑 누락 |
| 아키텍처 | WARN | 10건 | SOLID 위반 가능성, 탭 지연 로딩 전략 부재 |
| 보안 | WARN | 12건 | 클라이언트 측 권한 검증 한계 |
| 테스트 가능성 | PASS | 3건 | data-testid 체계적 정의 |

**이슈 분포:** P1(3) P2(12) P3(8) P4(7) P5(4) = **총 34건**

---

## 3. 심각도별 이슈 요약

### 3.1 Critical (1건)

| ID | 영역 | 설명 |
|----|------|------|
| SEC-001 | 보안/인가 | 클라이언트 측 권한 검증만으로는 수정/삭제 API 우회 가능. 백엔드 권한 검증 필수 |

### 3.2 High (5건)

| ID | 영역 | 설명 |
|----|------|------|
| ARCH-003 | 성능 | 탭 컨텐츠 지연 로딩 전략 부재 (초기 로딩 성능 저하 우려) |
| SEC-002 | 보안 | 삭제 API 소프트 삭제 vs 하드 삭제 미정의 |
| SEC-003 | 보안/XSS | Descriptions/탭 컨텐츠 렌더링 시 XSS 취약점 가능성 |
| SEC-004 | 보안/인가 | URL 직접 접근 시 권한 검증 미흡 |
| QA-001 | 품질/일관성 | 요구사항 ID 명명 규칙 불일치 (FR-001 vs FR-DETAIL-01) |

### 3.3 Medium (13건)

| ID | 영역 | 설명 |
|----|------|------|
| ARCH-001 | 아키텍처 | DetailTemplate 단일 책임 원칙(SRP) 위반 가능성 |
| ARCH-002 | 의존성 | Ant Design 타입 직접 노출 (결합도 높음) |
| ARCH-005 | 아키텍처 | 권한 처리 로직 불명확 (onEdit/onDelete vs permissions) |
| ARCH-009 | 확장성 | 도메인별 커스터마이징 포인트 미정의 |
| SEC-005 | 보안/세션 | 탭 전환 시 세션 유효성 검증 부재 |
| SEC-006 | 보안/데이터 | 민감 정보 표시 시 마스킹 고려 미흡 |
| SEC-007 | 보안 | 삭제 확인 다이얼로그 우회 가능성 |
| SEC-008 | 보안 | 브라우저 콘솔 민감 데이터 노출 우려 |
| QA-002 | 품질/추적성 | PRD 요구사항과 설계 문서 용어 불일치 |
| QA-004 | 품질/일관성 | Props 인터페이스 불일치 (permissions 속성) |
| QA-005 | 품질/일관성 | 비즈니스 규칙 ID 명명 불일치 및 추적 누락 |
| QA-007 | 품질/테스트 | 목록 복귀 시 상태 유지 테스트 누락 |
| QA-009 | 품질/추적성 | 유즈케이스-테스트 매핑 불완전 (UC-06, UC-07 누락) |

### 3.4 Low/Info (15건)

| ID | 영역 | 설명 |
|----|------|------|
| ARCH-004 | 확장성 | 에러 상태 타입 정의 불완전 |
| ARCH-006 | 컴포넌트 | 파일 구조 선택 기준 부재 |
| ARCH-007 | 성능 | Ant Design 트리쉐이킹 가이드라인 부재 |
| ARCH-008 | 의존성 | React 19 호환성 검증 항목 누락 |
| ARCH-010 | 일관성 | 추적성 매트릭스 요구사항 ID 불일치 |
| SEC-009 | 보안/인증 | 테스트 계정 자격 증명 하드코딩 |
| SEC-010 | 보안/CSRF | CSRF 보호 명시적 설계 부재 |
| SEC-011 | 보안/테스트 | 추적성 매트릭스에 보안 테스트 케이스 부재 |
| SEC-012 | 보안/정보 | 에러 메시지 정보 노출 검토 필요 |
| QA-003 | 품질/테스트 | 에러 상태 E2E 테스트 누락 |
| QA-006 | 품질/테스트 | 반응형 레이아웃 테스트 상세 부족 |
| QA-008 | 품질/테스트 | 삭제 중복 클릭 방지 테스트 누락 |
| QA-010 | 품질/테스트 | 키보드/접근성 테스트 상세 부족 |
| QA-011 | 품질/문서 | 체크리스트 미완료 상태 표기 |
| QA-012 | 품질/테스트 | 테스트 데이터와 Prisma 스키마 불일치 가능성 |

---

## 4. 상세 이슈 목록

### 4.1 Critical 이슈 상세

#### SEC-001: 클라이언트 측 권한 검증의 한계

| 항목 | 내용 |
|------|------|
| **심각도** | Critical |
| **우선순위** | P1 |
| **영역** | 보안 > 인가 |
| **참조 위치** | 010-design.md 섹션 8.1 BR-02 |
| **설명** | 설계 문서에서 권한 제어를 `onEdit/onDelete props 전달 여부`로만 처리. 클라이언트 측에서 버튼 숨기는 방식은 악의적 사용자가 브라우저 개발자 도구나 직접 API 호출을 통해 우회 가능 |
| **권장사항** | 1. 백엔드 API에서 반드시 권한 재검증 필수<br>2. 설계 문서에 "클라이언트 측 버튼 숨김은 UX 편의, 실제 권한 검증은 API 레이어에서 수행" 명시<br>3. API 응답에 사용자 권한 정보(canEdit, canDelete) 포함 권장 |

---

### 4.2 High 이슈 상세

#### ARCH-003: 탭 컨텐츠 지연 로딩 전략 부재

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 아키텍처 > 성능 |
| **참조 위치** | 010-design.md 섹션 8.1 BR-03 |
| **설명** | BR-03에 "탭 컨텐츠 지연 로딩 가능"을 명시하나 구체적 구현 전략 누락. `tabs.children: ReactNode` 설계로는 모든 탭 컨텐츠가 초기 렌더링 시 마운트됨 |
| **권장사항** | 1. `destroyInactiveTabPane` 옵션 지원 추가<br>2. `lazy: boolean` prop 추가<br>3. React.Suspense와 lazy import 가이드라인 제공 |

#### SEC-003: XSS 취약점 - Descriptions/탭 컨텐츠 렌더링

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P2 |
| **영역** | 보안 > XSS |
| **참조 위치** | 010-design.md 섹션 7.2-7.3 |
| **설명** | `descriptions.items[].children`과 `tabs[].children`이 `ReactNode` 타입. 사용자 입력 데이터 직접 렌더링 시 XSS 공격 노출 가능 |
| **권장사항** | 1. 사용자 입력 데이터는 텍스트로 렌더링 (React 자동 이스케이핑)<br>2. `dangerouslySetInnerHTML` 사용 시 DOMPurify 필수<br>3. CSP 헤더 설정으로 인라인 스크립트 차단 |

#### QA-001: 요구사항 ID 명명 규칙 불일치

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 품질 > 일관성 |
| **참조 위치** | 025-traceability-matrix.md 섹션 1, 026-test-specification.md 섹션 8 |
| **설명** | 추적성 매트릭스는 `FR-001`~`FR-006`, 테스트 명세서는 `FR-DETAIL-01`~`FR-DETAIL-07` 형식 사용. 동일 요구사항에 두 가지 ID 체계 혼재 |
| **권장사항** | 요구사항 ID를 하나의 체계로 통일 (예: `FR-DETAIL-XX`) 또는 매핑 테이블 추가 |

#### QA-004: Props 인터페이스 불일치

| 항목 | 내용 |
|------|------|
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 품질 > 일관성 |
| **참조 위치** | 010-design.md 섹션 7.2, 026-test-specification.md 섹션 1.3 |
| **설명** | 010-design.md의 DetailTemplateProps에는 `permissions` 속성이 없으나, 테스트 명세서에는 `permissions?: { canEdit?: boolean; canDelete?: boolean }` 정의됨 |
| **권장사항** | 설계 문서에 permissions 속성 추가 또는 테스트 명세서 수정 |

---

### 4.3 Medium 이슈 상세

#### ARCH-001: DetailTemplate 단일 책임 원칙(SRP) 위반 가능성

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 아키텍처 > SOLID |
| **참조 위치** | 010-design.md 섹션 7.2 Props 인터페이스 |
| **설명** | Props 인터페이스가 헤더, 기본 정보, 탭, 상태 관리, 레이아웃, 삭제 다이얼로그 등 6개 이상의 책임 혼재 |
| **권장사항** | Composition Pattern 적용 권장<br>```tsx<br><DetailTemplate><br>  <DetailTemplate.Header /><br>  <DetailTemplate.Descriptions /><br>  <DetailTemplate.Tabs /><br></DetailTemplate><br>``` |

#### ARCH-002: Ant Design 컴포넌트에 대한 강한 결합

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P2 |
| **영역** | 아키텍처 > 의존성 |
| **참조 위치** | 010-design.md 섹션 7.2, TRD 섹션 8 |
| **설명** | Props가 `DescriptionsProps`, `TabsProps` 등 Ant Design 타입을 직접 노출. 의존성 역전 원칙(DIP) 위반 |
| **권장사항** | 템플릿 자체의 추상화된 인터페이스 정의, Ant Design 타입 매핑은 내부 구현에서 처리 |

#### SEC-006: 민감 정보 표시 시 마스킹 고려 미흡

| 항목 | 내용 |
|------|------|
| **심각도** | Medium |
| **우선순위** | P3 |
| **영역** | 보안 > 데이터 노출 |
| **참조 위치** | 010-design.md 섹션 5.2 와이어프레임 |
| **설명** | 이메일, 전화번호 등 개인정보가 마스킹 없이 전체 표시. 숄더 서핑 공격에 취약 |
| **권장사항** | 민감 정보 마스킹 정책 수립 (예: `kim***@example.com`), 권한별 마스킹 해제 기능 |

---

## 5. 긍정적 평가 항목

| 영역 | 평가 내용 |
|------|----------|
| **유즈케이스 정의** | UC-01~UC-07까지 상세한 유즈케이스가 잘 정의됨 |
| **와이어프레임** | ASCII 와이어프레임이 정상/로딩/에러 상태별로 명확히 정의 |
| **Props 인터페이스** | 상세한 TypeScript 인터페이스와 JSDoc 주석 포함 |
| **사용 예시** | 실제 사용 예시 코드가 포함되어 개발자 참조 용이 |
| **data-testid 정의** | 모든 테스트 대상 요소에 대해 체계적으로 정의됨 |
| **에러 처리 설계** | 404, 500, 네트워크 에러에 대한 UI 처리 상세 정의 |
| **PRD/TRD 연계** | PRD 4.1.1과 TRD의 Ant Design 컴포넌트 매핑 연결 양호 |

---

## 6. 권장 조치 사항

### 6.1 구현 전 필수 조치 (P1)

| 순서 | 조치 항목 | 담당 |
|------|----------|------|
| 1 | 백엔드 API 권한 검증 설계 추가 (SEC-001) | 설계자 |
| 2 | 탭 지연 로딩 전략 보완 (ARCH-003) | 설계자 |
| 3 | 요구사항 ID 명명 규칙 통일 (QA-001, QA-004) | 문서 담당 |

### 6.2 구현 초기 조치 (P2)

| 순서 | 조치 항목 | 담당 |
|------|----------|------|
| 4 | XSS 방지 가이드라인 추가 (SEC-003) | 설계자 |
| 5 | URL 직접 접근 권한 검증 흐름 추가 (SEC-004) | 설계자 |
| 6 | 삭제 정책 명시 - 소프트 삭제 (SEC-002) | 설계자 |
| 7 | Props 인터페이스 Ant Design 타입 추상화 (ARCH-002) | 설계자 |
| 8 | 권한 처리 방식 통일 (ARCH-005) | 설계자 |
| 9 | 비즈니스 규칙 추적성 완성 (QA-005) | 문서 담당 |
| 10 | 에러 상태 E2E 테스트 추가 (QA-003) | 테스트 담당 |

### 6.3 구현 중 조치 (P3-P4)

| 순서 | 조치 항목 |
|------|----------|
| 11 | 세션 만료 처리 표준화 (SEC-005) |
| 12 | 민감 정보 마스킹 정책 수립 (SEC-006) |
| 13 | 반응형 레이아웃 E2E 테스트 추가 (QA-006) |
| 14 | 접근성 자동화 테스트 도입 (QA-010) |

### 6.4 후속 리팩토링 고려 (P5)

| 순서 | 조치 항목 |
|------|----------|
| 15 | Composition Pattern 적용 여부 결정 (ARCH-001) |
| 16 | 보안 요구사항 추적성 매트릭스 추가 (SEC-011) |

---

## 7. 리뷰 결론

**조건부 승인 (Conditionally Approved)**

### 승인 조건

1. **SEC-001** (클라이언트 권한 검증 한계) - 구현 전 백엔드 권한 검증 설계 문서화 필수
2. **ARCH-003** (탭 지연 로딩) - Props 설계에 lazy 로딩 옵션 추가 필수
3. **QA-001, QA-004** (ID/인터페이스 불일치) - 문서 일관성 수정 필수

### 승인 후 권장 사항

- P2 이슈들은 구현 중 점진적 개선 가능
- P3~P5 이슈들은 후속 리팩토링 시 반영 권장

---

---

## 8. 적용 결과 (2026-01-21)

### 8.1 적용 요약

| 구분 | 건수 | 비고 |
|------|------|------|
| ✅ 적용 | 9건 | P1 3건, P2 6건 |
| 📝 조정 적용 | 1건 | SEC-003 |
| ⏸️ 보류 | 6건 | 범위 초과, 시스템 부적합 |

### 8.2 적용된 이슈

| ID | 적용 내용 |
|----|----------|
| SEC-001 | BR-07 추가, permissions props 주석에 권한 검증 책임 명시 |
| ARCH-003 | lazyLoadTabs, destroyInactiveTabPane props 추가 |
| QA-001 | 테스트 명세서 요구사항 ID를 FR-XXX 형식으로 통일 |
| SEC-002 | BR-08 추가 (소프트 삭제 정책 명시) |
| SEC-003 | 보안 가이드라인 섹션(10) 추가 - XSS 방지 패턴 |
| SEC-004 | error.status에 403 추가, 에러 처리 섹션에 403 케이스 추가 |
| QA-004 | Props 인터페이스에 permissions 속성 추가 |
| QA-005 | 추적성 매트릭스에 BR-007, BR-008 추가 |
| QA-009 | 추적성 매트릭스에 UC-06, UC-07 매핑 추가 |

### 8.3 보류된 이슈

| ID | 보류 사유 |
|----|----------|
| ARCH-001 | SRP 위반 - 현재 규모에서 단일 컴포넌트가 적절. 향후 리팩토링 시 고려 |
| ARCH-002 | Ant Design 타입 노출 - 현 시스템 표준 라이브러리. 추상화 비용 > 이점 |
| ARCH-009 | 도메인별 커스터마이징 - 현재 Task 범위 초과. 실제 사용 사례 축적 후 결정 |
| SEC-005 | 세션 유효성 검증 - 글로벌 인증 미들웨어에서 처리. 컴포넌트 레벨 아님 |
| SEC-006 | 민감 정보 마스킹 - 도메인별 화면에서 처리. 템플릿 레벨 아님 |
| ARCH-005 | 권한 처리 로직 - permissions prop 추가로 해결, 추가 추상화 불필요 |

### 8.4 수정된 문서

| 문서 | 버전 | 주요 변경 |
|------|------|----------|
| 010-design.md | 2.0 → 2.1 | permissions, lazyLoadTabs, destroyInactiveTabPane 추가, 보안 가이드라인, BR-07/BR-08 |
| 025-traceability-matrix.md | 1.0 → 1.1 | UC-06/UC-07, BR-007/BR-008 매핑 추가 |
| 026-test-specification.md | 1.0 → 1.1 | Props 인터페이스 업데이트, 요구사항 ID 통일 |

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-21 | claude-1 | 최초 작성 - 아키텍처/보안/품질 3관점 통합 리뷰 |
| 1.1 | 2026-01-21 | claude | 적용 결과 섹션 추가 |
