# TSK-06-06 마법사(Wizard) 화면 템플릿 설계 리뷰

**Template Version:** 1.0.0 — **Last Updated:** 2026-01-21

| 항목 | 내용 |
|------|------|
| Task ID | TSK-06-06 |
| Task명 | 마법사(Wizard) 화면 템플릿 |
| 리뷰어 | Claude (claude-1) |
| 리뷰 일자 | 2026-01-21 |
| 설계 문서 버전 | 1.0 |

---

## 1. 리뷰 요약

### 1.1 종합 평가

마법사(Wizard) 화면 템플릿 설계는 **전반적으로 양호**합니다. PRD 요구사항을 충실히 반영하였고, Ant Design Steps 컴포넌트 기반의 설계가 TRD 기술 스택과 일관성을 유지하고 있습니다. 유즈케이스, 와이어프레임, Props 인터페이스 등이 상세하게 정의되어 있습니다.

그러나 다음 영역에서 개선이 필요합니다:
- 문서 간 일관성 (Props 인터페이스, data-testid 명명)
- WizardContext와 Form 인스턴스 간 결합도 감소
- 서버 사이드 보안 고려사항 강화
- 테스트 명세의 누락된 테스트 케이스 보완

### 1.2 검증 영역별 결과

| 검증 영역 | 평가 | 비고 |
|----------|------|------|
| 문서 완전성 | PASS | 필수 섹션 모두 포함 |
| 요구사항 추적성 | WARN | FR-006 추적성 누락, BR-005~008 미매핑 |
| 아키텍처 | WARN | Context 결합도, TSK-06-03 통합 전략 부재 |
| 보안 | WARN | 서버 사이드 검증, CSRF 보호 명세 필요 |
| 테스트 가능성 | WARN | UT-009~014 상세 누락, data-testid 불일치 |

### 1.3 이슈 분포

| 심각도 | 건수 |
|--------|------|
| Critical | 1 |
| High | 8 |
| Medium | 16 |
| Low | 9 |
| Info | 6 |
| **총계** | **40** |

---

## 2. 상세 이슈 목록

### 2.1 Critical 이슈

#### ISSUE-001: 클라이언트 사이드 유효성 검사 우회 가능성

| 항목 | 내용 |
|------|------|
| **이슈 ID** | SEC-001 |
| **심각도** | Critical |
| **우선순위** | P1 |
| **영역** | 보안 - 입력 유효성 검사 |
| **위치** | 010-design.md 섹션 7.2, 10.1.1 |

**설명:**
설계 문서에서 "서버 사이드 검사 필수"를 언급하고 있으나, 실제 `onFinish` 콜백 및 단계별 `validate` 함수 구현에서 서버 사이드 검증 로직이 명시적으로 정의되어 있지 않습니다. 클라이언트 검증만으로는 브라우저 개발자 도구를 통한 우회가 가능합니다.

**권장 조치:**
1. API 엔드포인트의 서버 사이드 유효성 검사 명세 추가 (입력 스키마 정의)
2. `onFinish` 콜백이 호출하는 API의 백엔드 검증 로직 별도 문서화
3. 각 단계별 필드에 대한 서버 사이드 검증 규칙 매핑 테이블 추가

---

### 2.2 High 이슈

#### ISSUE-002: WizardContext와 Form 인스턴스 간 결합도 문제

| 항목 | 내용 |
|------|------|
| **이슈 ID** | ARCH-001 |
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 아키텍처 - 상태 관리 |
| **위치** | 010-design.md 섹션 7.3, 13.2 |

**설명:**
`WizardContext`가 데이터 관리와 네비게이션 상태를 모두 담당하며, validate 함수가 클로저를 통해 외부 Form 인스턴스를 참조합니다. 이 구조는 Form 인스턴스와 Context 간 암묵적 결합을 발생시킵니다.

**권장 조치:**
1. FormRegistry 패턴 도입: Context 내에 Form 인스턴스를 등록/해제할 수 있는 레지스트리 추가
2. 또는 `useWizardStep` 훅을 제공하여 단계 컴포넌트가 자동으로 Form을 Context에 등록하도록 추상화

---

#### ISSUE-003: TSK-06-03 FormTemplate과의 통합 전략 부재

| 항목 | 내용 |
|------|------|
| **이슈 ID** | ARCH-002 |
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 아키텍처 - 컴포넌트 통합 |
| **위치** | 010-design.md 섹션 11.3 |

**설명:**
TSK-06-03(입력/수정 폼 템플릿)에 대한 의존성을 명시하고 있으나, 실제 통합 방식이 구체화되어 있지 않습니다. 이탈 경고, 저장 처리 등의 책임이 중복될 수 있습니다.

**권장 조치:**
1. 계층 분리 명확화: WizardTemplate은 전체 흐름 제어, 단계별 폼은 FormTemplate의 일부 기능만 사용
2. 설계 문서에 통합 가이드라인 추가

---

#### ISSUE-004: Props 인터페이스 불일치 (설계 vs 테스트)

| 항목 | 내용 |
|------|------|
| **이슈 ID** | QA-001 |
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 문서 일관성 |
| **위치** | 010-design.md 라인 770-836, 026-test-specification.md 라인 49-85 |

**설명:**
설계 문서의 `WizardTemplateProps` 인터페이스와 테스트 명세의 인터페이스가 일치하지 않습니다:
- 설계: `onFinish`, `initialStep`, `initialData`
- 테스트: `onComplete`, `currentStep`

**권장 조치:**
설계 문서의 Props 명칭을 기준으로 테스트 명세를 통일

---

#### ISSUE-005: 요구사항 ID 체계 불일치

| 항목 | 내용 |
|------|------|
| **이슈 ID** | QA-002 |
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 요구사항 추적성 |
| **위치** | 025-traceability-matrix.md 섹션 1, 026-test-specification.md 섹션 8 |

**설명:**
추적성 매트릭스에서 FR-001~FR-005로 정의된 요구사항이 테스트 명세에서 FR-006(진행 상황 시각화)으로 확장되어 있으나, 추적성 매트릭스에 누락되어 있습니다.

**권장 조치:**
추적성 매트릭스에 FR-006 추가

---

#### ISSUE-006: 테스트 케이스 ID 매핑 오류

| 항목 | 내용 |
|------|------|
| **이슈 ID** | QA-003 |
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 테스트 커버리지 |
| **위치** | 025-traceability-matrix.md 섹션 3, 026-test-specification.md 섹션 2 |

**설명:**
추적성 매트릭스에서 정의한 UT-001~UT-014와 테스트 명세의 UT-001~UT-008이 일치하지 않습니다. UT-009~UT-014 상세가 누락되어 있습니다.

**권장 조치:**
테스트 명세에 UT-009~UT-014 테스트 케이스 상세 추가

---

#### ISSUE-007: CSRF 보호 메커니즘 미정의

| 항목 | 내용 |
|------|------|
| **이슈 ID** | SEC-002 |
| **심각도** | High |
| **우선순위** | P1 |
| **영역** | 보안 - CSRF 방지 |
| **위치** | 010-design.md 섹션 3.2 UC-07 |

**설명:**
마법사 완료 시 API 호출하여 데이터를 저장하는 흐름이 정의되어 있으나, CSRF 보호에 대한 언급이 없습니다.

**권장 조치:**
1. API 호출 시 CSRF 토큰 포함 명세 추가
2. Next.js SameSite 쿠키 정책 적용 가이드라인 추가

---

#### ISSUE-008: 민감 데이터 처리 가이드라인 불충분

| 항목 | 내용 |
|------|------|
| **이슈 ID** | SEC-003 |
| **심각도** | High |
| **우선순위** | P2 |
| **영역** | 보안 - 민감 데이터 |
| **위치** | 010-design.md 섹션 10.1.3 |

**설명:**
민감 데이터 처리 방법을 일반적으로 언급하고 있으나, WizardContext에서 민감 데이터가 메모리에 평문으로 저장되는 문제, 확인 단계에서 마스킹 처리 등의 구체적인 가이드라인이 부족합니다.

**권장 조치:**
1. 민감 데이터 필드 식별 속성 추가 고려
2. 확인 단계에서 민감 데이터 마스킹 처리 가이드라인 추가

---

#### ISSUE-009: 세션 타임아웃 처리 미정의

| 항목 | 내용 |
|------|------|
| **이슈 ID** | SEC-004 |
| **심각도** | High |
| **우선순위** | P2 |
| **영역** | 보안 - 세션 관리 |
| **위치** | 010-design.md 섹션 9.1 |

**설명:**
마법사 진행 중 세션이 만료되었을 때의 구체적인 처리 흐름이 정의되어 있지 않습니다. 복잡한 마법사에서 오랜 시간 입력 작업 시 세션 만료 가능성이 있습니다.

**권장 조치:**
1. 세션 만료 감지 메커니즘 명세 추가
2. 입력 데이터 임시 저장 및 재인증 후 복원 흐름 정의

---

### 2.3 Medium 이슈

| 이슈 ID | 영역 | 설명 | 우선순위 |
|---------|------|------|----------|
| ARCH-003 | 인터페이스 | WizardStep.content의 유연성과 타입 안전성 트레이드오프 | P2 |
| ARCH-004 | 인터페이스 | autoConfirmStep/autoFinishStep의 암묵적 단계 추가 동작 불명확 | P2 |
| ARCH-005 | 비즈니스 규칙 | BR-04 allowStepClick과 순차 진행 규칙 모순 | P3 |
| ARCH-006 | 문서 일관성 | Props 명칭 불일치 (onFinish vs onComplete) | P3 |
| ARCH-007 | 확장성 | 대용량 단계 데이터 처리 전략 부재 | P3 |
| QA-004 | 추적성 | PRD 4단계 구성이 고정인지 가변인지 불명확 | P2 |
| QA-005 | 테스트 | data-testid 불일치 (wizard-template-container vs wizard-container) | P2 |
| QA-006 | 테스트 | 이탈 경고 다이얼로그 testid 불일치 | P2 |
| QA-007 | 추적성 | BR-005~BR-008 추적성 매트릭스 누락 | P2 |
| QA-008 | 문서 | 체크리스트 상태 오류 (025, 026 존재하나 미완료 표시) | P3 |
| QA-009 | 테스트 | E2E 테스트 시나리오 부족 (UC-06~09 커버리지) | P2 |
| QA-010 | 성능 | 렌더링 최적화, 상태 관리 효율성 기술 부족 | P3 |
| SEC-005 | 보안 | 에러 메시지 정보 노출 위험 | P3 |
| SEC-006 | 보안 | XSS 방어 명세 구체화 필요 (확인 단계) | P3 |
| SEC-007 | 보안 | Rate Limiting 및 중복 제출 방지 서버 측 미정의 | P3 |
| SEC-008 | 보안 | 인증/인가 검증 흐름 미상세 | P3 |

---

### 2.4 Low 이슈

| 이슈 ID | 영역 | 설명 | 우선순위 |
|---------|------|------|----------|
| ARCH-008 | 확장성 | WizardNavigation 버튼 커스터마이징 제한 | P4 |
| ARCH-009 | 접근성 | ARIA 속성 상세 명세 부족 | P4 |
| ARCH-010 | 테스트 | data-testid 네이밍 컨벤션 불일치 | P4 |
| ARCH-011 | 문서 | 추적성 매트릭스 PRD 원문 연결 강화 필요 | P5 |
| QA-011 | 테스트 | UT-005 요구사항 참조 오류 (FR-003 → BR-002) | P3 |
| QA-012 | 문서 | 문서 상태 불일치 ("작성중" → "설계 완료") | P4 |
| QA-013 | 테스트 | 접근성 단위 테스트 누락 | P4 |
| SEC-009 | 보안 | beforeunload 이탈 경고 브라우저 제한사항 | P4 |
| SEC-010 | 테스트 | 테스트 계정 정보 평문 노출 | P5 |

---

### 2.5 Info 이슈

| 이슈 ID | 영역 | 설명 | 우선순위 |
|---------|------|------|----------|
| ARCH-012 | 안정성 | 에러 바운더리 전략 미정의 | P5 |
| ARCH-013 | 성능 | Context 분할, React.memo 등 최적화 기법 미문서화 | P5 |
| QA-014 | 테스트 | wizard-confirmation, wizard-result 셀렉터 누락 | P5 |
| QA-015 | 문서 | 샘플 코드 import 경로 확인 필요 | P5 |
| SEC-011 | 보안 | CSP 정책 구체화 권장 | P5 |
| SEC-012 | 테스트 | 보안 테스트 케이스 부재 | P5 |

---

## 3. SOLID 원칙 준수 평가

| 원칙 | 준수 수준 | 비고 |
|------|---------|------|
| **S**ingle Responsibility | 개선 필요 | WizardContext가 데이터+네비게이션+Form 연동 모두 담당 |
| **O**pen/Closed | 양호 | Props 확장으로 커스터마이징 가능, 버튼 커스터마이징은 제한적 |
| **L**iskov Substitution | 해당없음 | 상속 구조 없음 |
| **I**nterface Segregation | 양호 | 선택적 Props로 필요한 기능만 활성화 |
| **D**ependency Inversion | 개선 필요 | validate 함수가 구체적 Form 인스턴스에 의존 |

---

## 4. TRD 기술 스택 준수 확인

| 기술 요소 | TRD 명세 | 설계 문서 | 준수 여부 |
|----------|---------|---------|---------|
| UI 컴포넌트 | Ant Design 6.x | Steps, Card, Button, Result, Descriptions, Modal | ✅ 준수 |
| 상태 관리 | React Context | WizardContext | ✅ 준수 |
| 스타일링 | Ant Design Token + TailwindCSS | className props | ✅ 준수 |
| Client Component | 'use client' 필요 시 | 섹션 11.6에 명시 | ✅ 준수 |
| 테스트 | Vitest + Playwright | 026-test-specification.md | ✅ 준수 |

---

## 5. 권장 조치 요약 (우선순위순)

### P1 (구현 전 필수 수정)

| 순번 | 이슈 ID | 조치 내용 | 예상 공수 |
|------|---------|----------|----------|
| 1 | SEC-001 | 서버 사이드 유효성 검사 명세 추가 | 1일 |
| 2 | SEC-002 | CSRF 보호 메커니즘 정의 | 0.5일 |
| 3 | ARCH-001 | FormRegistry 패턴 또는 useWizardStep 훅 도입 설계 | 2일 |
| 4 | ARCH-002 | TSK-06-03 통합 가이드라인 문서화 | 1일 |
| 5 | QA-001 | Props 인터페이스 통일 (설계 기준) | 0.5일 |
| 6 | QA-002 | FR-006 추적성 매트릭스 추가 | 0.5일 |
| 7 | QA-003 | UT-009~UT-014 테스트 케이스 상세 추가 | 1일 |

### P2 (리뷰 승인 전 수정)

| 순번 | 이슈 ID | 조치 내용 | 예상 공수 |
|------|---------|----------|----------|
| 8 | SEC-003 | 민감 데이터 처리 가이드라인 구체화 | 0.5일 |
| 9 | SEC-004 | 세션 타임아웃 처리 흐름 정의 | 0.5일 |
| 10 | ARCH-003 | content prop ReactNode 전용 권장 문서화 | 0.5일 |
| 11 | ARCH-004 | autoConfirmStep/autoFinishStep 동작 명확화 | 0.5일 |
| 12 | QA-004~007 | 추적성 매트릭스 보완 | 0.5일 |
| 13 | QA-009 | E2E 테스트 시나리오 보완 | 0.5일 |

### P3 이상 (구현 중/후 검토)

- 문서 상태/체크리스트 업데이트
- 성능 고려사항 섹션 추가
- 접근성 상세 명세 보완
- 보안 테스트 케이스 추가

---

## 6. 긍정적 요소

1. **완성도 높은 유즈케이스 정의**: UC-01~UC-10까지 상세한 시나리오 정의
2. **Ant Design 활용 최적화**: Steps, Result, Descriptions 등 기업용 컴포넌트 활용
3. **비즈니스 규칙 명세**: BR-01~BR-08까지 8개의 명확한 규칙 정의
4. **반응형 설계**: 데스크톱/태블릿/모바일 대응 와이어프레임 포함
5. **다크 모드 지원**: 테마 전환 고려사항 포함
6. **기본 보안 원칙**: XSS 방어, 민감 데이터 처리 섹션 포함

---

## 7. 결론

TSK-06-06 마법사 화면 템플릿 설계는 PRD 요구사항을 충실히 반영하고 TRD 기술 스택과 일관성을 유지하는 **양호한 설계**입니다.

**핵심 개선 영역:**
1. **서버 사이드 보안 강화** (SEC-001, SEC-002) - 가장 중요한 보안 개선점
2. **WizardContext와 Form 결합도 감소** (ARCH-001) - 핵심 아키텍처 개선점
3. **문서 간 일관성 확보** (QA-001~003, ARCH-006) - 구현 시 혼란 방지
4. **TSK-06-03 통합 전략** (ARCH-002) - 재사용성 향상

**P1 이슈 7건을 반드시 수정한 후** 설계 승인을 진행하는 것을 권장합니다.

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-21 | Claude | 최초 작성 (아키텍처/보안/품질 3개 관점 통합) |
