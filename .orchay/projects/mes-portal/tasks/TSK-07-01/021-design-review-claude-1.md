# TSK-07-01 설계 리뷰 보고서

## 문서 정보

| 항목 | 내용 |
|------|------|
| Task ID | TSK-07-01 |
| Task명 | 대시보드 레이아웃 설계 |
| 리뷰 일자 | 2026-01-21 |
| 리뷰어 | claude-1 |
| 상태 | 리뷰 완료 |

---

## 검증 대상 문서

| 문서 | 상태 | 비고 |
|------|------|------|
| 010-design.md | ✅ | 통합 설계 문서 |
| 025-traceability-matrix.md | ✅ | 추적성 매트릭스 |
| 026-test-specification.md | ✅ | 테스트 명세서 |

---

## 검증 결과 요약

| 검증 영역 | 평가 | 이슈 수 | 비고 |
|----------|------|---------|------|
| 문서 완전성 | PASS | 0 | 필수 섹션 모두 포함 |
| 요구사항 추적성 | PASS | 0 | FR 5, BR 2 매핑 완료 |
| 아키텍처 | WARN | 5 | P2 2건, P3 3건 개선 권장 |
| 보안 | PASS | 1 | P2 1건 (구현 시 적용) |
| 품질 | WARN | 5 | P2 5건 문서 일관성 개선 필요 |
| 테스트 가능성 | WARN | 2 | 테스트 전략 재검토 필요 |

### 이슈 분포

| 심각도 | 개수 |
|--------|------|
| Critical | 0 |
| High | 2 |
| Medium | 9 |
| Low | 8 |
| Info | 4 |
| **총계** | **23** |

---

## 1. 아키텍처 리뷰 결과

### 1.1 SOLID 원칙 준수

| 원칙 | 평가 | 비고 |
|------|------|------|
| 단일 책임 원칙 (SRP) | PASS | 컴포넌트별 역할 분리 적절 |
| 개방-폐쇄 원칙 (OCP) | PASS | WidgetCard 확장성 설계 양호 |
| 의존성 역전 원칙 (DIP) | WARN | 데이터 계층 추상화 필요 |

### 1.2 아키텍처 이슈

#### [ARCH-004] 데이터 계층 추상화 부족
- **심각도**: High
- **우선순위**: P2
- **영역**: 아키텍처
- **설명**: 설계 문서에서 데이터 로딩 방식이 JSON import로 직접 연결되어 있습니다. TRD 섹션 2.3에서는 "환경변수로 Mock/API 분기" 전략을 제시하고 있으나, 컴포넌트 설계에서 데이터 서비스 추상화 계층이 명시되어 있지 않습니다.
- **권장 조치**:
  1. 데이터 페칭 레이어 추상화 추가
  2. 컴포넌트는 추상 인터페이스(예: `DashboardDataService`)에 의존하도록 설계
  ```typescript
  interface DashboardDataService {
    getKPIData(): Promise<DashboardKPI>;
    getProductionTrend(): Promise<ProductionTrendItem[]>;
    getLinePerformance(): Promise<LinePerformanceItem[]>;
    getRecentActivities(): Promise<ActivityItem[]>;
  }
  ```
- **관련 섹션**: 010-design.md 7.1, TRD 2.3

#### [ARCH-010] 데이터 연동 전환 시 변경 범위 불명확
- **심각도**: High
- **우선순위**: P2
- **영역**: 아키텍처
- **설명**: Mock 데이터에서 실제 API로 전환 시 어떤 컴포넌트들이 수정되어야 하는지 명시되어 있지 않습니다.
- **권장 조치**:
  1. 데이터 로딩 책임 위치를 명확히 정의
  2. TRD의 apiClient 추상화 패턴 적용 명시
  3. 변경 영향 범위 문서화
- **관련 섹션**: 010-design.md 7.1, 11.7

#### [ARCH-003] 위젯 타입별 렌더링 전략 미정의
- **심각도**: Medium
- **우선순위**: P3
- **영역**: 아키텍처
- **설명**: 현재 설계는 3가지 섹션(KPI, 차트, 최근 활동)으로 고정되어 있습니다. 향후 새로운 위젯 타입 추가 시 확장 메커니즘이 명시되어 있지 않습니다.
- **권장 조치**: 위젯 타입 레지스트리 패턴 도입 검토
- **관련 섹션**: 010-design.md 1.3, 11.2

#### [ARCH-008] 위젯 배치 하드코딩 우려
- **심각도**: Medium
- **우선순위**: P3
- **영역**: 아키텍처
- **설명**: 위젯 배치가 코드에 하드코딩되어 있어 향후 위젯 구성 변경 시 코드 수정이 필요합니다.
- **권장 조치**: Phase 1에서는 현재 설계 유지, 향후 확장을 위한 로드맵에 위젯 구성 설정화 포함
- **관련 섹션**: 010-design.md 1.3

#### [ARCH-016] 에러 경계(Error Boundary) 전략 미정의
- **심각도**: Medium
- **우선순위**: P3
- **영역**: 아키텍처
- **설명**: BR-05(위젯별 독립 에러 처리)를 구현하기 위한 React Error Boundary 적용 범위가 명시되어 있지 않습니다.
- **권장 조치**:
  1. WidgetCard에 Error Boundary 내장 또는
  2. 각 Section 컴포넌트를 Error Boundary로 래핑
- **관련 섹션**: 010-design.md 9.1, BR-05

---

## 2. 보안 리뷰 결과

### 2.1 보안 검토 요약

| 영역 | 상태 | 비고 |
|------|------|------|
| OWASP Top 10 (XSS) | PASS | React 자동 이스케이프 적용 |
| OWASP Top 10 (민감정보 노출) | PASS | Mock 데이터에 민감 정보 미포함 |
| 인증/인가 | 보완 필요 | 대시보드 접근 권한 검증 구현 필요 |
| 데이터 보안 | PASS | 클라이언트 사이드 노출 위험 낮음 |

### 2.2 보안 이슈

#### [SEC-003] 대시보드 접근 권한 검증
- **심각도**: Medium
- **우선순위**: P2
- **영역**: 보안
- **설명**: UC-01(대시보드 진입)에서 "사전 조건: 로그인 완료, 대시보드 메뉴 접근 권한"이 명시되어 있으나, 구현 시 권한 검증 로직에 대한 구체적인 설계가 부재합니다.
- **권장 조치**:
  1. `/app/(portal)/dashboard/page.tsx`에서 세션 검증 로직 구현 필수
  2. 미인증 사용자 접근 시 로그인 페이지로 리다이렉트
  3. middleware.ts에서 라우트 보호 적용
- **관련 섹션**: 010-design.md 3.2 UC-01

---

## 3. 품질 리뷰 결과

### 3.1 문서 완전성

**PASS** - 모든 필수 섹션이 포함되어 있습니다.

### 3.2 요구사항 추적성

**PASS** - 모든 요구사항이 매핑되어 있습니다.

| 요구사항 | 설계 | 테스트 | 상태 |
|----------|------|--------|------|
| FR-001 (위젯 기반 레이아웃) | O | UT-001, E2E-001 | 완료 |
| FR-002 (KPI 카드 영역) | O | UT-002, E2E-002 | 완료 |
| FR-003 (차트 영역) | O | UT-003, E2E-003 | 완료 |
| FR-004 (최근 활동 영역) | O | UT-004, E2E-004 | 완료 |
| FR-005 (반응형 그리드) | O | UT-005~007, E2E-005~007 | 완료 |
| BR-001 (반응형 컬럼 조정) | O | UT-005~007 | 완료 |
| BR-002 (최소 높이 유지) | O | UT-008 | 완료 |

### 3.3 품질 이슈 (문서 일관성)

#### [QR-001] 추적성 매트릭스 설계 섹션 참조 불일치
- **심각도**: Medium
- **우선순위**: P2
- **영역**: 품질
- **설명**: 025-traceability-matrix.md에서 설계 섹션 번호(3.1, 3.2 등)가 010-design.md의 실제 섹션 구조와 일치하지 않습니다. 매트릭스에서 참조하는 "3.1 DashboardLayout"은 010-design.md에서 유즈케이스 섹션입니다.
- **권장 조치**: 추적성 매트릭스의 설계 섹션 참조를 실제 섹션 번호로 수정
- **관련 섹션**: 025-traceability-matrix.md 섹션 1

#### [QR-003] data-testid 명명 불일치
- **심각도**: Medium
- **우선순위**: P2
- **영역**: 품질
- **설명**: 010-design.md와 026-test-specification.md의 data-testid가 일부 다릅니다.
  - 010-design.md: `recent-activity-section`
  - 026-test-specification.md: `activity-section`
- **권장 조치**: 두 문서의 data-testid를 통일
- **관련 섹션**: 010-design.md 11.8, 026-test-specification.md 6.2

#### [QR-006] 테스트 코드 예시의 selector 불일치
- **심각도**: Medium
- **우선순위**: P2
- **영역**: 품질
- **설명**: 026-test-specification.md의 테스트 코드 예시에서 사용하는 selector와 정의된 data-testid가 일치하지 않습니다.
  - 정의: `kpi-card-operation-rate`
  - 테스트 코드: `kpi-slot-1`
- **권장 조치**: 테스트 코드 예시의 selector를 정의된 data-testid와 일치시키거나, 슬롯 기반 접근 방식 채택 시 data-testid 목록에 슬롯 ID 추가
- **관련 섹션**: 026-test-specification.md 2.2, 3.2

#### [QR-007] 반응형 단위 테스트의 실효성 문제
- **심각도**: Medium
- **우선순위**: P2
- **영역**: 품질
- **설명**: UT-005~007의 반응형 테스트에서 `window.innerWidth` 조작 방식은 Ant Design의 CSS 기반 반응형 동작을 JSDOM 환경에서 정확히 검증하지 못합니다.
- **권장 조치**:
  1. 반응형 동작 검증은 E2E 테스트에 의존
  2. 단위 테스트에서는 props 전달 및 컴포넌트 렌더링만 확인
- **관련 섹션**: 026-test-specification.md 2.2

#### [QR-008] 추적성 매트릭스의 breakpoint 규칙 불일치
- **심각도**: Medium
- **우선순위**: P2
- **영역**: 품질
- **설명**: 025-traceability-matrix.md의 BR-001 breakpoint 규칙이 010-design.md와 다릅니다.
  - 매트릭스: xl(>=1200px): 4컬럼, lg(>=992px): 3컬럼
  - 설계 문서: xl(1600px+): 4컬럼, lg(1200-1599px): 4컬럼
- **권장 조치**: 추적성 매트릭스의 breakpoint 규칙을 설계 문서와 일치시키기
- **관련 섹션**: 025-traceability-matrix.md 2.1, 010-design.md 5.3

---

## 4. 전체 이슈 목록

| 이슈 ID | 제목 | 심각도 | 우선순위 | 영역 |
|---------|------|--------|----------|------|
| ARCH-004 | 데이터 계층 추상화 부족 | High | P2 | 아키텍처 |
| ARCH-010 | 데이터 연동 전환 시 변경 범위 불명확 | High | P2 | 아키텍처 |
| SEC-003 | 대시보드 접근 권한 검증 | Medium | P2 | 보안 |
| QR-001 | 추적성 매트릭스 설계 섹션 참조 불일치 | Medium | P2 | 품질 |
| QR-003 | data-testid 명명 불일치 | Medium | P2 | 품질 |
| QR-006 | 테스트 코드 예시의 selector 불일치 | Medium | P2 | 품질 |
| QR-007 | 반응형 단위 테스트의 실효성 문제 | Medium | P2 | 품질 |
| QR-008 | 추적성 매트릭스의 breakpoint 규칙 불일치 | Medium | P2 | 품질 |
| ARCH-003 | 위젯 타입별 렌더링 전략 미정의 | Medium | P3 | 아키텍처 |
| ARCH-008 | 위젯 배치 하드코딩 우려 | Medium | P3 | 아키텍처 |
| ARCH-016 | 에러 경계(Error Boundary) 전략 미정의 | Medium | P3 | 아키텍처 |
| QR-002 | 테스트 명세서 파일 경로 불일치 | Low | P3 | 품질 |
| QR-004 | BR-002 E2E 테스트 누락 | Low | P3 | 품질 |
| QR-009 | WidgetCard 에러 상태 재시도 동작 미정의 | Low | P3 | 품질 |
| SEC-004 | 위젯별 데이터 접근 권한 | Low | P3 | 보안 |
| ARCH-005 | Section 컴포넌트와 WidgetCard 역할 중복 가능성 | Low | P4 | 아키텍처 |
| ARCH-012 | CSS 변수 활용 계획 미명시 | Low | P4 | 아키텍처 |
| ARCH-014 | Client Component 과다 사용 검토 필요 | Low | P4 | 아키텍처 |
| ARCH-015 | 타입 정의 위치 명확화 필요 | Low | P4 | 아키텍처 |
| QR-005 | PRD 파이 차트 요구사항 미반영 | Info | P4 | 품질 |
| QR-010 | 테스트 명세서 뷰포트 크기 불일치 | Low | P4 | 품질 |
| SEC-001 | XSS 취약점 (향후 API 연동 시 주의) | Low | P4 | 보안 |
| SEC-006 | 클라이언트 사이드 데이터 노출 | Low | P4 | 보안 |

---

## 5. 권장 조치 우선순위

### P2 (구현 전 수정 권장) - 8건

1. **ARCH-004, ARCH-010**: 데이터 서비스 추상화 계층 설계 추가
   - `DashboardDataService` 인터페이스 정의
   - Mock/API 전환 전략 명시

2. **SEC-003**: 대시보드 접근 권한 검증 구현 계획 명시
   - page.tsx에서 세션 검증 로직

3. **QR-001, QR-008**: 추적성 매트릭스 수정
   - 설계 섹션 참조 번호 수정
   - breakpoint 규칙 일치시키기

4. **QR-003, QR-006**: data-testid 통일
   - 010-design.md와 026-test-specification.md 간 일관성 확보

5. **QR-007**: 반응형 단위 테스트 전략 재검토
   - E2E 테스트로 반응형 검증, 단위 테스트 범위 조정

### P3 (구현 중 수정 가능) - 6건

- ARCH-003, ARCH-008, ARCH-016: 향후 확장성 전략 명시
- QR-002, QR-004, QR-009: 테스트 명세 보완
- SEC-004: 역할별 위젯 접근 권한 로드맵

### P4 (향후 개선) - 9건

- 코드 품질 및 최적화 관련 개선 사항

---

## 6. 종합 의견

### 설계 품질 평가

전반적으로 **양호한 설계**입니다. PRD 요구사항(FR 5건, BR 2건)에 대한 커버리지가 100%이며, SOLID 원칙의 단일 책임과 컴포넌트 분리가 잘 되어 있습니다. Ant Design 활용과 Server/Client Component 구분이 TRD 가이드라인을 준수하고 있습니다.

### 주요 개선 필요 영역

1. **데이터 계층 추상화** (ARCH-004, ARCH-010)
   - Mock에서 API로의 전환을 고려한 서비스 레이어 추상화가 필요합니다
   - TRD 8.3의 `apiClient` 패턴 적용 권장

2. **문서 간 일관성** (QR-001, QR-003, QR-006, QR-008)
   - 추적성 매트릭스, 테스트 명세서, 설계 문서 간 참조 및 명명 통일 필요

3. **보안 구현 계획** (SEC-003)
   - 대시보드 접근 권한 검증 로직 구현 필요

### 승인 권고

P2 우선순위 이슈 8건에 대한 설계 보완 후 구현 진행을 권장합니다. 특히:
- 데이터 서비스 추상화 계층 설계 추가
- 문서 간 data-testid 및 섹션 참조 통일
- 접근 권한 검증 구현 계획 명시

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-21 | Claude | 최초 작성 (아키텍처/보안/품질 통합 리뷰) |

---

<!--
wf:review 산출물
리뷰어: claude-1
Task: TSK-07-01
-->
