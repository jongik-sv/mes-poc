# RBAC 권한 관리 화면 분리 - PRD (Product Requirements Document)

## 1. 개요

### 1.1 프로젝트명
RBAC Enhancement - 권한 관리 화면 분리

### 1.2 목적
기존 `/system/authority` 4-column 통합 화면을 역할 분리 원칙에 따라 2개 화면으로 분리하여 사용성과 유지보수성 향상

### 1.3 배경
- 현재 `/system/authority` 화면은 User → RoleGroups → Roles → Permissions를 4-column으로 한 화면에 표시
- 별도로 `/system/role-groups` 화면이 역할그룹 CRUD + 역할 할당 기능으로 존재
- 역할그룹 정의(관리자 업무)와 사용자 권한 할당(운영 업무)은 업무 성격이 다름
- 화면 복잡도 감소 및 업무 흐름 개선 필요

---

## 2. 목표

### 2.1 비즈니스 목표
- 역할그룹 정의와 사용자 권한 할당 업무를 명확히 분리
- 관리자가 역할그룹-역할-권한 계층을 직관적으로 관리
- 운영자가 사용자별 역할그룹 할당 및 메뉴 접근 범위를 즉시 확인

### 2.2 기술 목표
- 3-column master-detail 레이아웃으로 정보 밀도 최적화
- MDI 탭 영역 전체를 활용하는 전체 화면 레이아웃
- 메뉴 시뮬레이션으로 권한 할당 결과 실시간 미리보기

---

## 3. 사용자

### 3.1 주요 사용자
| 사용자 유형 | 역할 | 주요 기능 |
|------------|------|----------|
| 시스템 관리자 | RBAC 체계 정의 | 역할그룹 정의 화면 — 역할그룹/역할/권한 CRUD 및 매핑 |
| 보안 관리자 | 사용자 권한 할당 | 사용자 역할그룹 할당 화면 — 사용자별 역할그룹 배정, 메뉴 접근 확인 |
| 운영 관리자 | 권한 배정 현황 확인 | 사용자 역할그룹 할당 화면 — 메뉴 시뮬레이션으로 접근 범위 검증 |

---

## 4. 기능 요구사항

### 4.1 화면 1: 역할그룹 정의 (`/system/role-groups`)

#### 4.1.1 역할그룹 목록 (좌측 컬럼, 35%)
- [x] 역할그룹 목록 테이블 (코드, 이름, 시스템, 상태, 액션) — 기존 구현
- [x] 검색 (이름/코드), 시스템 필터, 상태 필터 — 기존 구현
- [x] 역할그룹 등록/수정/삭제 모달 — 기존 구현
- [ ] 행 클릭 시 중앙 역할 패널 갱신

#### 4.1.2 역할 관리 (중앙 컬럼, 33%)
- [ ] 선택된 역할그룹의 역할 할당 현황 표시
- [ ] 상단: 할당된 역할 테이블 (이름, 코드, 상태, 액션)
- [ ] 하단: 전체 역할 테이블 (체크박스, 이름, 코드, 상태)
- [ ] 역할 검색, 상태 필터
- [ ] 역할 등록/수정 모달, 삭제 Popconfirm
- [ ] 할당 저장 버튼
- [ ] 할당된 역할 행 클릭 시 우측 권한 패널 갱신

#### 4.1.3 권한 관리 (우측 컬럼, 32%)
- [ ] 선택된 역할의 권한 할당 현황 표시
- [ ] 상단: 할당된 권한 테이블 (이름, 코드, 유형, 액션)
- [ ] 하단: 전체 권한 테이블 (체크박스, 이름, 코드, 유형)
- [ ] 권한 검색, 유형 필터 (메뉴/API/데이터)
- [ ] 권한 등록/수정 모달, 삭제 Popconfirm
- [ ] 할당 저장 버튼

### 4.2 화면 2: 사용자 역할그룹 할당 (`/system/authority`)

#### 4.2.1 사용자 목록 (좌측 컬럼, 30%)
- [ ] 사용자 목록 테이블 (이름, 이메일, 상태)
- [ ] 이름/이메일 검색
- [ ] 상태 필터 (활성/비활성/전체)
- [ ] 행 클릭 시 중앙 역할그룹 + 우측 메뉴 시뮬레이션 갱신

#### 4.2.2 역할그룹 할당 (중앙 컬럼, 35%)
- [ ] 상단: 보유 역할그룹 테이블 (이름, 코드, 상태) — read-only
- [ ] 하단: 전체 역할그룹 테이블 (체크박스, 이름, 코드, 상태)
- [ ] 저장 버튼으로 할당 반영
- [ ] 체크박스 변경 시 우측 메뉴 시뮬레이션 실시간 갱신 (저장 전 미리보기)

#### 4.2.3 메뉴 시뮬레이션 (우측 컬럼, 35%)
- [ ] Ant Design Tree 컴포넌트로 접근 가능 메뉴 표시
- [ ] 사이드바와 동일한 아이콘 매핑 사용
- [ ] 카테고리 기반 폴더 구조 (defaultExpandAll)
- [ ] read-only (클릭해도 네비게이션 없음)
- [ ] 접근 가능 메뉴 수/카테고리 수 요약 표시
- [ ] 역할그룹 체크박스 변경 시 실시간 갱신

### 4.3 API

#### 4.3.1 사용자 메뉴 시뮬레이션 API (신규)
- [ ] `GET /api/users/{id}/menus` — 사용자 역할그룹 기반 접근 가능 메뉴 트리 조회
- [ ] 응답: 카테고리별 그룹핑된 메뉴 트리 구조
- [ ] 역할그룹 ID 목록을 쿼리 파라미터로 받아 시뮬레이션 지원

---

## 5. 비기능 요구사항

### 5.1 성능
- 각 컬럼의 데이터 로딩은 선택 이벤트 발생 시 lazy loading
- 메뉴 시뮬레이션은 체크박스 변경 후 300ms debounce 적용

### 5.2 UX
- 전체 화면 레이아웃 (`h-full flex flex-col` 패턴)
- 선택되지 않은 상태에서 중앙/우측 컬럼은 안내 메시지 표시
- 할당 변경 시 저장하지 않고 다른 항목 선택 시 변경사항 유실 경고

### 5.3 스타일링
- Ant Design Token 시스템 준수
- CSS Variables 활용
- 인라인 스타일, 개별 CSS 파일 금지
- TailwindCSS는 레이아웃 보조용으로만 사용
