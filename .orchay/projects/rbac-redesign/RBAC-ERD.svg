<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="700" viewBox="0 0 1200 700">
  <!-- Background -->
  <rect width="1200" height="700" fill="#ffffff"/>

  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1f2937">RBAC Permission System ERD</text>
  <text x="600" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#6b7280">User → RoleGroup → Role → Permission (No RoleMenu, No UserRole)</text>

  <!-- ========================================== -->
  <!-- SECTION BACKGROUNDS (drawn first = behind) -->
  <!-- ========================================== -->
  <rect x="30" y="70" width="300" height="500" rx="10" fill="#f0f9ff" stroke="#bae6fd" stroke-width="2"/>
  <rect x="380" y="70" width="440" height="620" rx="10" fill="#f0fdf4" stroke="#86efac" stroke-width="2"/>
  <rect x="870" y="70" width="300" height="500" rx="10" fill="#fef2f2" stroke="#fecaca" stroke-width="2"/>

  <!-- Section Titles -->
  <text x="180" y="95" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#0369a1">MENU SECTION</text>
  <text x="600" y="95" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#166534">USER SECTION</text>
  <text x="1020" y="95" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="#dc2626">PERMISSION / ROLE</text>

  <!-- ========================================== -->
  <!-- MENU SECTION ENTITIES -->
  <!-- ========================================== -->

  <!-- Menu (Bottom) -->
  <rect x="60" y="400" width="240" height="100" rx="6" fill="#fff" stroke="#374151" stroke-width="2"/>
  <rect x="60" y="400" width="240" height="22" rx="6" fill="#1f2937"/>
  <text x="180" y="415" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#fff">Menu</text>
  <text x="75" y="435" font-family="Consolas" font-size="9"><tspan fill="#7c3aed" font-weight="bold">PK</tspan><tspan fill="#374151"> menuId</tspan></text>
  <text x="75" y="450" font-family="Consolas" font-size="9" fill="#374151">menuCd (UK), name, path, icon</text>
  <text x="75" y="465" font-family="Consolas" font-size="9" fill="#059669">category (조업관리/생산실적)</text>
  <text x="75" y="480" font-family="Consolas" font-size="9" fill="#374151">sortOrder (varchar), isActive</text>

  <!-- MenuSetMenu (Middle) -->
  <rect x="100" y="280" width="160" height="70" rx="6" fill="#fef3c7" stroke="#d97706" stroke-width="2"/>
  <rect x="100" y="280" width="160" height="20" rx="6" fill="#d97706"/>
  <text x="180" y="294" text-anchor="middle" font-family="Arial" font-size="9" font-weight="bold" fill="#fff">MenuSetMenu</text>
  <text x="115" y="315" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> menuSetId</tspan></text>
  <text x="115" y="330" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> menuId</tspan></text>

  <!-- MenuSet (Top) -->
  <rect x="60" y="120" width="240" height="90" rx="6" fill="#fff" stroke="#374151" stroke-width="2"/>
  <rect x="60" y="120" width="240" height="22" rx="6" fill="#1f2937"/>
  <text x="180" y="135" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#fff">MenuSet</text>
  <text x="75" y="155" font-family="Consolas" font-size="9"><tspan fill="#7c3aed" font-weight="bold">PK</tspan><tspan fill="#374151"> menuSetId</tspan></text>
  <text x="75" y="170" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> systemId</tspan></text>
  <text x="75" y="185" font-family="Consolas" font-size="9" fill="#374151">menuSetCd (UK), name, description</text>
  <text x="75" y="200" font-family="Consolas" font-size="9" fill="#374151">isDefault, isActive</text>

  <!-- ========================================== -->
  <!-- USER SECTION ENTITIES -->
  <!-- ========================================== -->

  <!-- System -->
  <rect x="420" y="120" width="200" height="90" rx="6" fill="#fff" stroke="#374151" stroke-width="2"/>
  <rect x="420" y="120" width="200" height="22" rx="6" fill="#1f2937"/>
  <text x="520" y="135" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#fff">System</text>
  <text x="435" y="155" font-family="Consolas" font-size="9"><tspan fill="#7c3aed" font-weight="bold">PK</tspan><tspan fill="#374151"> systemId</tspan></text>
  <text x="435" y="170" font-family="Consolas" font-size="9" fill="#374151">systemCd (UK), name, domain</text>
  <text x="435" y="185" font-family="Consolas" font-size="9" fill="#374151">description, isActive</text>

  <!-- User -->
  <rect x="420" y="260" width="360" height="120" rx="6" fill="#fff" stroke="#374151" stroke-width="2"/>
  <rect x="420" y="260" width="360" height="22" rx="6" fill="#1f2937"/>
  <text x="600" y="275" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold" fill="#fff">User</text>
  <text x="435" y="295" font-family="Consolas" font-size="10"><tspan fill="#7c3aed" font-weight="bold">PK</tspan><tspan fill="#374151"> userId</tspan></text>
  <text x="435" y="312" font-family="Consolas" font-size="10" fill="#374151">email (UK), name, password</text>
  <text x="435" y="329" font-family="Consolas" font-size="10" fill="#374151">phone, department</text>
  <text x="435" y="346" font-family="Consolas" font-size="10" fill="#374151">isActive, isLocked, lastLoginAt</text>
  <text x="435" y="363" font-family="Consolas" font-size="10" fill="#374151">mustChangePassword</text>

  <!-- UserSystemMenuSet -->
  <rect x="420" y="430" width="170" height="80" rx="6" fill="#fef3c7" stroke="#d97706" stroke-width="2"/>
  <rect x="420" y="430" width="170" height="20" rx="6" fill="#d97706"/>
  <text x="505" y="444" text-anchor="middle" font-family="Arial" font-size="8" font-weight="bold" fill="#fff">UserSystemMenuSet</text>
  <text x="435" y="465" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> userId</tspan></text>
  <text x="435" y="480" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> systemId</tspan></text>
  <text x="435" y="495" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> menuSetId</tspan></text>

  <!-- UserRoleGroup -->
  <rect x="610" y="430" width="170" height="80" rx="6" fill="#fef3c7" stroke="#d97706" stroke-width="2"/>
  <rect x="610" y="430" width="170" height="20" rx="6" fill="#d97706"/>
  <text x="695" y="444" text-anchor="middle" font-family="Arial" font-size="9" font-weight="bold" fill="#fff">UserRoleGroup</text>
  <text x="625" y="465" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> userId</tspan></text>
  <text x="625" y="480" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> roleGroupId</tspan></text>
  <text x="625" y="495" font-family="Consolas" font-size="9" fill="#374151">assignedAt, assignedBy</text>

  <!-- ========================================== -->
  <!-- PERMISSION/ROLE SECTION ENTITIES -->
  <!-- ========================================== -->

  <!-- RoleGroup (Top) -->
  <rect x="900" y="110" width="240" height="70" rx="6" fill="#fff" stroke="#374151" stroke-width="2"/>
  <rect x="900" y="110" width="240" height="22" rx="6" fill="#1f2937"/>
  <text x="1020" y="125" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#fff">RoleGroup</text>
  <text x="915" y="145" font-family="Consolas" font-size="9"><tspan fill="#7c3aed" font-weight="bold">PK</tspan><tspan fill="#374151"> roleGroupId</tspan></text>
  <text x="915" y="160" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> systemId</tspan></text>
  <text x="915" y="173" font-family="Consolas" font-size="9" fill="#374151">roleGroupCd (UK), name, isActive</text>

  <!-- RoleGroupRole -->
  <rect x="940" y="195" width="160" height="55" rx="6" fill="#fef3c7" stroke="#d97706" stroke-width="2"/>
  <rect x="940" y="195" width="160" height="20" rx="6" fill="#d97706"/>
  <text x="1020" y="209" text-anchor="middle" font-family="Arial" font-size="9" font-weight="bold" fill="#fff">RoleGroupRole</text>
  <text x="955" y="227" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> roleGroupId</tspan></text>
  <text x="955" y="242" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> roleId</tspan></text>

  <!-- Role -->
  <rect x="900" y="265" width="240" height="70" rx="6" fill="#fff" stroke="#374151" stroke-width="2"/>
  <rect x="900" y="265" width="240" height="22" rx="6" fill="#1f2937"/>
  <text x="1020" y="280" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#fff">Role</text>
  <text x="915" y="300" font-family="Consolas" font-size="9"><tspan fill="#7c3aed" font-weight="bold">PK</tspan><tspan fill="#374151"> roleId</tspan></text>
  <text x="915" y="315" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> parentRoleId (self)</tspan></text>
  <text x="1040" y="300" font-family="Consolas" font-size="9" fill="#374151">roleCd (UK), name, level</text>
  <text x="1040" y="315" font-family="Consolas" font-size="9" fill="#374151">isSystem, isActive</text>

  <!-- RolePermission -->
  <rect x="940" y="350" width="160" height="55" rx="6" fill="#fef3c7" stroke="#d97706" stroke-width="2"/>
  <rect x="940" y="350" width="160" height="20" rx="6" fill="#d97706"/>
  <text x="1020" y="364" text-anchor="middle" font-family="Arial" font-size="9" font-weight="bold" fill="#fff">RolePermission</text>
  <text x="955" y="382" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> roleId</tspan></text>
  <text x="955" y="397" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> permissionId</tspan></text>

  <!-- Permission (Bottom) -->
  <rect x="900" y="420" width="240" height="105" rx="6" fill="#fff" stroke="#374151" stroke-width="2"/>
  <rect x="900" y="420" width="240" height="22" rx="6" fill="#1f2937"/>
  <text x="1020" y="435" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#fff">Permission</text>
  <text x="915" y="455" font-family="Consolas" font-size="9"><tspan fill="#7c3aed" font-weight="bold">PK</tspan><tspan fill="#374151"> permissionId</tspan></text>
  <text x="915" y="470" font-family="Consolas" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#374151"> menuId</tspan></text>
  <text x="915" y="485" font-family="Consolas" font-size="9" fill="#374151">permissionCd (UK), name</text>
  <text x="915" y="500" font-family="Consolas" font-size="9" fill="#059669">config (JSON)</text>
  <text x="915" y="515" font-family="Consolas" font-size="9" fill="#374151">isActive</text>

  <!-- ========================================== -->
  <!-- ALL CONNECTION LINES (drawn on top) -->
  <!-- ========================================== -->

  <!-- Menu Section Internal Relations -->
  <!-- Menu: No self-reference (uses category path instead) -->

  <!-- MenuSet → MenuSetMenu -->
  <line x1="180" y1="210" x2="180" y2="280" stroke="#6b7280" stroke-width="1.5"/>
  <polygon points="176,278 180,286 184,278" fill="#6b7280"/>

  <!-- MenuSetMenu → Menu -->
  <line x1="180" y1="350" x2="180" y2="400" stroke="#6b7280" stroke-width="1.5"/>
  <polygon points="176,398 180,406 184,398" fill="#6b7280"/>

  <!-- User Section Internal Relations -->
  <!-- User → UserSystemMenuSet -->
  <line x1="505" y1="380" x2="505" y2="430" stroke="#6b7280" stroke-width="1.5"/>
  <polygon points="501,428 505,436 509,428" fill="#6b7280"/>

  <!-- User → UserRoleGroup -->
  <line x1="695" y1="380" x2="695" y2="430" stroke="#6b7280" stroke-width="1.5"/>
  <polygon points="691,428 695,436 699,428" fill="#6b7280"/>

  <!-- Permission/Role Section Internal Relations -->
  <!-- Role self-reference -->
  <polyline points="1140,305 1155,305 1155,285 1140,285" fill="none" stroke="#6b7280" stroke-width="1.5"/>
  <polygon points="1142,281 1134,285 1142,289" fill="#6b7280"/>
  <text x="1165" y="298" font-family="Arial" font-size="7" fill="#6b7280">parent</text>

  <!-- RoleGroup → RoleGroupRole -->
  <line x1="1020" y1="180" x2="1020" y2="195" stroke="#6b7280" stroke-width="1.5"/>
  <polygon points="1016,193 1020,201 1024,193" fill="#6b7280"/>

  <!-- RoleGroupRole → Role -->
  <line x1="1020" y1="250" x2="1020" y2="265" stroke="#6b7280" stroke-width="1.5"/>
  <polygon points="1016,263 1020,271 1024,263" fill="#6b7280"/>

  <!-- Role → RolePermission -->
  <line x1="1020" y1="335" x2="1020" y2="350" stroke="#6b7280" stroke-width="1.5"/>
  <polygon points="1016,348 1020,356 1024,348" fill="#6b7280"/>

  <!-- RolePermission → Permission -->
  <line x1="1020" y1="405" x2="1020" y2="420" stroke="#6b7280" stroke-width="1.5"/>
  <polygon points="1016,418 1020,426 1024,418" fill="#6b7280"/>

  <!-- ========================================== -->
  <!-- CROSS-SECTION RELATIONS -->
  <!-- ========================================== -->

  <!-- System → MenuSet (systemId) -->
  <polyline points="420,165 340,165 300,165" fill="none" stroke="#0ea5e9" stroke-width="2"/>
  <polygon points="302,161 294,165 302,169" fill="#0ea5e9"/>
  <text x="360" y="158" font-family="Arial" font-size="8" fill="#0ea5e9">systemId</text>

  <!-- System → RoleGroup (systemId) -->
  <polyline points="620,165 760,165 900,145" fill="none" stroke="#dc2626" stroke-width="2"/>
  <polygon points="898,147 906,141 900,149" fill="#dc2626"/>
  <text x="760" y="158" font-family="Arial" font-size="8" fill="#dc2626">systemId</text>

  <!-- UserSystemMenuSet → MenuSet -->
  <polyline points="420,470 360,470 360,180 300,180" fill="none" stroke="#0ea5e9" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="302,176 294,180 302,184" fill="#0ea5e9"/>

  <!-- UserRoleGroup → RoleGroup -->
  <polyline points="780,470 840,470 840,145 900,145" fill="none" stroke="#dc2626" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="898,141 906,145 898,149" fill="#dc2626"/>

  <!-- Permission → Menu (menuId) - routing around bottom -->
  <polyline points="900,470 850,470 850,540 350,540 350,450 300,450" fill="none" stroke="#8b5cf6" stroke-width="1.5" stroke-dasharray="5,3"/>
  <polygon points="302,446 294,450 302,454" fill="#8b5cf6"/>
  <text x="600" y="555" font-family="Arial" font-size="9" fill="#8b5cf6" text-anchor="middle">Permission.menuId → Menu</text>

  <!-- ========================================== -->
  <!-- LEGEND & FLOW -->
  <!-- ========================================== -->
  <rect x="420" y="560" width="360" height="120" rx="8" fill="#fff" stroke="#e5e7eb" stroke-width="1"/>

  <!-- Legend -->
  <text x="440" y="582" font-family="Arial" font-size="11" font-weight="bold" fill="#374151">Legend</text>
  <rect x="440" y="592" width="20" height="12" rx="2" fill="#fff" stroke="#374151" stroke-width="1.5"/>
  <text x="470" y="602" font-family="Arial" font-size="9" fill="#6b7280">Entity</text>
  <rect x="530" y="592" width="20" height="12" rx="2" fill="#fef3c7" stroke="#d97706" stroke-width="1.5"/>
  <text x="560" y="602" font-family="Arial" font-size="9" fill="#6b7280">Mapping</text>
  <text x="630" y="602" font-family="Arial" font-size="9"><tspan fill="#7c3aed" font-weight="bold">PK</tspan><tspan fill="#6b7280"> Primary</tspan></text>
  <text x="700" y="602" font-family="Arial" font-size="9"><tspan fill="#2563eb">FK</tspan><tspan fill="#6b7280"> Foreign</tspan></text>

  <!-- Permission Flow -->
  <text x="440" y="625" font-family="Arial" font-size="10" font-weight="bold" fill="#166534">Permission Flow</text>
  <text x="440" y="642" font-family="Consolas" font-size="9" fill="#15803d">User → UserRoleGroup → RoleGroup → RoleGroupRole</text>
  <text x="440" y="657" font-family="Consolas" font-size="9" fill="#15803d">     → Role → RolePermission → Permission</text>

  <!-- Menu Flow -->
  <text x="440" y="675" font-family="Arial" font-size="10" font-weight="bold" fill="#0369a1">Menu Flow</text>
  <text x="560" y="675" font-family="Consolas" font-size="9" fill="#0ea5e9">User → UserSystemMenuSet → MenuSet → Menu</text>

</svg>
