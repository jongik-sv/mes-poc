# 사용자 매뉴얼 (080-manual.md)

**Template Version:** 1.0.0 — **Last Updated:** 2026-01-27

---

## 0. 문서 메타데이터

| 항목 | 내용 |
|------|------|
| Task ID | TSK-03-02 |
| Task명 | 시스템/역할그룹/권한 정의 관리 화면 |
| 대상 기능 | RBAC 시스템/역할그룹/권한 관리 |
| 작성일 | 2026-01-27 |
| 버전 | 1.0.0 |

---

# 사용자 매뉴얼: RBAC 시스템/역할그룹/권한 관리

**버전:** 1.0.0 — **최종 수정일:** 2026-01-27

---

## 1. 개요

RBAC(역할 기반 접근 제어) 관리 화면은 멀티 테넌트 환경에서 시스템, 역할그룹, 권한을 체계적으로 관리하기 위한 관리자 전용 기능입니다.

### 1.1 화면 구성

```
사이드바 > 시스템 관리
├── 시스템 목록       (/system/systems)      - 테넌트(공장/도메인) 관리
├── 역할그룹          (/system/role-groups)   - 역할그룹 관리 + 역할 할당
├── 권한 관리         (/system/permissions)   - 메뉴별 권한 정의
├── 역할              (/system/roles)         - 역할 상세 + 권한 할당
└── 사용자            (/system/users)         - 사용자 상세 + 역할그룹/권한 확인
```

### 1.2 주요 기능 요약

| 화면 | 설명 |
|------|------|
| 시스템 관리 | 멀티 테넌트 시스템(공장/도메인) 등록, 수정, 삭제 |
| 역할그룹 관리 | 역할그룹 CRUD, 포함 역할 관리, 시스템별 필터링 |
| 권한 관리 | 메뉴 트리 기반 권한 정의 (Actions + Field Constraints) |
| 역할 관리 | 역할 상세 확인, 메뉴-권한 매트릭스 기반 권한 할당 |
| 사용자 관리 | 역할그룹 할당, 시스템 접근 현황, 최종 권한 확인 |

---

## 2. 시나리오별 사용 가이드

### 시나리오 1: 신규 시스템(테넌트) 등록

**목표**: 새로운 공장/도메인을 시스템으로 등록한다.

#### 단계별 안내

**Step 1.** 사이드바에서 [시스템 관리] > [시스템 목록] 메뉴를 클릭한다.

**Step 2.** 화면 우측 상단의 [시스템 등록] 버튼을 클릭한다.

**Step 3.** 생성 모달에서 필수 정보를 입력한다.

| 항목 | 설명 | 필수 |
|------|------|------|
| 시스템 ID | 영문/숫자/하이픈, 3-50자 (예: factory2) | 예 |
| 시스템명 | 시스템 표시 이름 (예: 제2공장) | 예 |
| 도메인 | 시스템 도메인 (예: f2.mes.com), 고유해야 함 | 예 |
| 설명 | 시스템에 대한 부가 설명 | 아니오 |
| 활성 상태 | 시스템 활성화 여부 (기본: 활성) | 예 |

**Step 4.** [저장] 버튼을 클릭하면 시스템이 등록되고 목록에 표시된다.

> **Tip**: 시스템 목록에서 활성 상태 스위치를 토글하여 시스템을 활성화/비활성화할 수 있습니다.

---

### 시나리오 2: 역할그룹 생성 및 역할 할당

**목표**: 역할그룹을 생성하고, 포함할 역할을 할당한다.

#### 단계별 안내

**Step 1.** [시스템 관리] > [역할그룹] 메뉴를 클릭한다.

**Step 2.** [역할그룹 등록] 버튼을 클릭한다.

**Step 3.** 역할그룹 정보를 입력한다.

| 항목 | 설명 |
|------|------|
| 코드 | 역할그룹 고유 코드 (예: RG-PROD-01) |
| 이름 | 역할그룹명 (예: 생산관리그룹) |
| 소속 시스템 | 드롭다운에서 시스템 선택 |

**Step 4.** [저장] 클릭 후, 목록에서 생성된 역할그룹 행을 클릭한다.

**Step 5.** 우측 상세 패널에서 [포함 역할] 섹션의 [추가] 버튼을 클릭한다.

**Step 6.** 역할 선택 모달에서 추가할 역할을 체크하고 [확인]을 클릭한다.

> **Tip**: 상단의 시스템 필터 드롭다운으로 특정 시스템의 역할그룹만 필터링할 수 있습니다.

---

### 시나리오 3: 메뉴별 권한 정의

**목표**: 특정 메뉴에 대한 권한(Actions + Field Constraints)을 정의한다.

#### 단계별 안내

**Step 1.** [시스템 관리] > [권한 관리] 메뉴를 클릭한다.

**Step 2.** 좌측 메뉴 트리에서 권한을 정의할 메뉴 노드를 클릭한다.

**Step 3.** 우측 패널에 해당 메뉴의 기존 권한 목록이 표시된다. [권한 추가] 버튼을 클릭한다.

**Step 4.** 권한 생성 모달에서 정보를 입력한다.

| 항목 | 설명 |
|------|------|
| 권한 코드 | 고유 코드 (예: PROD-RU) |
| 권한명 | 표시 이름 (예: 생산편집) |
| Actions | CREATE, READ, UPDATE, DELETE, EXPORT, IMPORT 중 선택 |
| Field Constraints | 필드명-허용값 쌍 (선택, 예: lineId = LINE-01,LINE-02) |

**Step 5.** [저장] 클릭 시 권한이 생성되어 목록에 추가된다.

> **주의**: Actions는 최소 1개 이상 선택해야 합니다.

---

### 시나리오 4: 역할에 권한 할당

**목표**: 특정 역할에 메뉴별 권한을 할당한다.

#### 단계별 안내

**Step 1.** [시스템 관리] > [역할] 메뉴에서 역할 목록을 확인한다.

**Step 2.** 권한을 할당할 역할 행을 클릭하면 우측에 Drawer가 열린다.

**Step 3.** [권한 할당] 탭을 클릭한다.

**Step 4.** 메뉴 트리와 권한 매트릭스가 표시된다. 각 권한의 Action별 체크박스를 토글하여 할당/해제한다.

```
메뉴              | 권한명    | C | R | U | D | EX | IM
──────────────────┼──────────┼───┼───┼───┼───┼────┼────
조업관리 > 생산계획 | 계획조회 |   | ☑ |   |   |    |
조업관리 > 생산실적 | 실적편집 | ☑ | ☑ | ☑ | ☑ | ☑  | ☑
```

**Step 5.** [저장] 버튼을 클릭하여 변경사항을 반영한다.

---

### 시나리오 5: 사용자 역할그룹 할당 및 최종 권한 확인

**목표**: 사용자에게 역할그룹을 할당하고, 최종 권한을 확인한다.

#### 단계별 안내

**Step 1.** [시스템 관리] > [사용자] 메뉴에서 대상 사용자 행을 클릭한다.

**Step 2.** Drawer가 열리면 [역할그룹] 탭을 클릭한다.

**Step 3.** [역할그룹 추가] 버튼으로 역할그룹을 할당한다.

**Step 4.** [시스템 접근] 탭에서 사용자가 접근 가능한 시스템 목록을 확인한다.

**Step 5.** [최종 권한] 탭에서 사용자의 합산된 최종 권한을 메뉴별로 확인한다.

| 표시 항목 | 설명 |
|----------|------|
| 메뉴명 | 메뉴 트리 구조로 표시 |
| Actions | 해당 메뉴에 대한 최종 권한 (합집합) |
| 권한 출처 | 어떤 역할그룹 > 역할 경로를 통해 부여되었는지 |

> **Tip**: 최종 권한은 사용자에게 할당된 모든 역할그룹 > 역할 > 권한의 합집합으로 계산됩니다.

---

## 3. 키보드 단축키

| 키 | 동작 |
|----|------|
| **Esc** | 열린 모달 또는 Drawer 닫기 |
| **Enter** | 모달 내 폼 제출 (저장) |
| **방향키 상/하/좌/우** | 메뉴 트리 노드 탐색 (권한 관리 화면) |
| **Tab** | 폼 필드 간 이동 |

---

## 4. 상태별 화면

| 상태 | 화면 |
|------|------|
| 로딩 중 | Skeleton 로딩 표시 |
| 에러 | "문제가 발생했습니다. 다시 시도해주세요." 알림 표시 |
| 데이터 없음 | "등록된 항목이 없습니다. [등록] 버튼으로 추가하세요." 안내 |
| 메뉴 미선택 (권한 관리) | "왼쪽 메뉴 트리에서 메뉴를 선택하세요." 안내 |
| 정상 | 테이블에 데이터 목록 표시 |

---

## 5. FAQ / 트러블슈팅

### Q1. 시스템을 삭제할 수 없습니다.
- 해당 시스템에 소속된 역할그룹이 있으면 삭제할 수 없습니다.
- 먼저 해당 시스템의 역할그룹을 모두 삭제하거나 다른 시스템으로 이동한 후 삭제하세요.

### Q2. 역할그룹을 삭제할 수 없습니다.
- 해당 역할그룹에 할당된 사용자가 있으면 삭제할 수 없습니다.
- 먼저 사용자의 역할그룹 할당을 해제한 후 삭제하세요.

### Q3. 사용자의 최종 권한 탭에 "할당된 역할그룹이 없습니다"가 표시됩니다.
- 해당 사용자에게 역할그룹이 할당되지 않은 상태입니다.
- [역할그룹] 탭에서 역할그룹을 먼저 할당하세요.

### Q4. 도메인 중복 에러가 발생합니다.
- 시스템 도메인은 고유해야 합니다. 다른 시스템에서 이미 사용 중인 도메인입니다.
- 다른 도메인을 입력하세요.

---

## 6. 접근성

### 6.1 키보드 지원
- 모든 버튼과 폼 요소에 Tab 키로 접근 가능
- 모달/Drawer는 Esc 키로 닫기 가능
- 메뉴 트리는 방향키로 탐색 가능

### 6.2 스크린 리더
- `aria-label`: 주요 버튼 (시스템 등록, 역할그룹 등록, 권한 추가 등)
- `role`: dialog (모달), tree (메뉴 트리), table (목록)
- `aria-expanded`: 메뉴 트리 폴더 노드 펼침/접기 상태

### 6.3 색상 대비
- WCAG AA 기준 명암비 충족 (Ant Design 6 기본 테마)
- 색상만으로 정보 구분하지 않음 (활성/비활성은 텍스트 라벨 병행)

---

## 7. 관련 문서

| 문서 | 경로 |
|------|------|
| 설계 문서 | `tasks/TSK-03-02/010-design.md` |
| 요구사항 추적 | `tasks/TSK-03-02/025-traceability-matrix.md` |
| 구현 보고서 | `tasks/TSK-03-02/030-implementation.md` |
| 테스트 결과서 | `tasks/TSK-03-02/070-tdd-test-results.md` |

---

## 8. 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0.0 | 2026-01-27 | 초기 작성 |

---

<!--
Author: AI Agent (Claude)
Template Version: 1.0.0
Created: 2026-01-27
Based on: TSK-03-02 (시스템/역할그룹/권한 정의 관리 화면)
-->
